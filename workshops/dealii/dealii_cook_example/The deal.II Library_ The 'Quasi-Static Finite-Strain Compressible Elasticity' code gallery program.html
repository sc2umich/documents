<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0115)https://www.dealii.org/current/doxygen/deal.II/code_gallery_Quasi_static_Finite_strain_Compressible_Elasticity.html -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/code_gallery_Quasi_static_Finite_strain_Compressible_Elasticity.html">

<meta http-equiv="X-UA-Compatible" content="IE=11">
<meta name="generator" content="Doxygen 1.9.7">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The deal.II Library: The 'Quasi-Static Finite-Strain Compressible Elasticity' code gallery program</title>
<link href="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/jquery.js.download"></script>
<script type="text/javascript" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/dynsections.js.download"></script>
<link href="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/search.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/searchdata.js.download"></script>
<script type="text/javascript" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/search.js.download"></script>
<script type="text/x-mathjax-config;executed=true">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/MathJax.js.download"></script>
<link href="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/doxygen.css" rel="stylesheet" type="text/css">
<link href="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/stylesheet.css" rel="stylesheet" type="text/css">
<link rel="SHORTCUT ICON" href="https://www.dealii.org/current/doxygen/deal.II/deal.ico">
<script type="text/javascript" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/custom.js.download"></script>
<meta name="author" content="The deal.II Authors &lt;authors@dealii.org&gt;">
<meta name="copyright" content="Copyright (C) 1998 - 2023 by the deal.II authors">
<meta name="deal.II-version" content="9.5.0">
<style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.7') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.7') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.7') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.7') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.7') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.7') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.7') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.7') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.7') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_Math-bold-italic; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf?V=2.7.7') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_Fraktur; src: url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff?V=2.7.7') format('woff'), url('https://www.dealii.org/current/doxygen/deal.II/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf?V=2.7.7') format('opentype')}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>
<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br><br><br><br></div></div><div id="MathJax_Message" style="display: none;"></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/logo200.png"></td>
  <td id="projectalign">
   <div id="projectname"><span id="projectnumber">&nbsp;Reference documentation for deal.II version 9.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
<span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 0em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.812em, 1000em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mrow" id="MathJax-Span-2"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}</script>
<span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3" style="width: 0em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.812em, 1000em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mrow" id="MathJax-Span-4"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}</script>
<span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-5" style="width: 0em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.812em, 1000em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mrow" id="MathJax-Span-6"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}</script>
<span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-7" style="width: 0em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.812em, 1000em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mrow" id="MathJax-Span-8"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/menudata.js.download"></script>
<script type="text/javascript" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/menu.js.download"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div class="sm sm-dox"><input id="main-menu-state" type="checkbox"><label class="main-menu-btn" for="main-menu-state"><span class="main-menu-btn-icon"></span> Toggle main menu visibility</label><span id="searchBoxPos1" style="position:absolute;right:8px;top:8px;height:36px;"></span></div><div id="main-nav"><ul class="sm sm-dox" id="main-menu" data-smartmenus-id="17095734497174714"><li><a href="https://www.dealii.org/current/doxygen/deal.II/index.html">Main Page</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/Tutorial.html">Tutorial</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/CodeGallery.html">Code gallery</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/modules.html">Modules</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespaces.html" class="has-submenu" id="sm-17095734497174714-1" aria-haspopup="true" aria-controls="sm-17095734497174714-2" aria-expanded="false">Namespaces<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-2" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-1" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespaces.html">Namespace List</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers.html" class="has-submenu" id="sm-17095734497174714-3" aria-haspopup="true" aria-controls="sm-17095734497174714-4" aria-expanded="false">Namespace Members<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-4" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-3" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers.html" class="has-submenu" id="sm-17095734497174714-5" aria-haspopup="true" aria-controls="sm-17095734497174714-6" aria-expanded="false">All<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-6" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-5" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_j.html#index_j">j</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_k.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_q.html#index_q">q</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_r.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_u.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_v.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_w.html#index_w">w</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_z.html#index_z">z</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func.html" class="has-submenu" id="sm-17095734497174714-7" aria-haspopup="true" aria-controls="sm-17095734497174714-8" aria-expanded="false">Functions<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-8" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-7" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_j.html#index_j">j</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_k.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_q.html#index_q">q</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_r.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_u.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_v.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_func_w.html#index_w">w</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html" class="has-submenu" id="sm-17095734497174714-9" aria-haspopup="true" aria-controls="sm-17095734497174714-10" aria-expanded="false">Variables<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-10" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-9" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_q">q</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_w">w</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_vars.html#index_z">z</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html" class="has-submenu" id="sm-17095734497174714-11" aria-haspopup="true" aria-controls="sm-17095734497174714-12" aria-expanded="false">Typedefs<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-12" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-11" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_type.html#index_v">v</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html" class="has-submenu" id="sm-17095734497174714-13" aria-haspopup="true" aria-controls="sm-17095734497174714-14" aria-expanded="false">Enumerations<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-14" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-13" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_enum.html#index_v">v</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html" class="has-submenu" id="sm-17095734497174714-15" aria-haspopup="true" aria-controls="sm-17095734497174714-16" aria-expanded="false">Enumerator<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-16" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-15" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/namespacemembers_eval.html#index_w">w</a></li></ul></li></ul></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/annotated.html" class="has-submenu" id="sm-17095734497174714-17" aria-haspopup="true" aria-controls="sm-17095734497174714-18" aria-expanded="false">Classes<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-18" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-17" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/annotated.html">Class List</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/classes.html">Class Index</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/hierarchy.html">Class Hierarchy</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions.html" class="has-submenu" id="sm-17095734497174714-19" aria-haspopup="true" aria-controls="sm-17095734497174714-20" aria-expanded="false">Class Members<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-20" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-19" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions.html" class="has-submenu" id="sm-17095734497174714-21" aria-haspopup="true" aria-controls="sm-17095734497174714-22" aria-expanded="false">All<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-22" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-21" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions.html#index_:">:</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions__.html#index__5F">_</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_a.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_j.html#index_j">j</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_k.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_q.html#index_q">q</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_r.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_u.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_v.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_w.html#index_w">w</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_x.html#index_x">x</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_y.html#index_y">y</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_z.html#index_z">z</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_~.html#index__7E">~</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func.html" class="has-submenu" id="sm-17095734497174714-23" aria-haspopup="true" aria-controls="sm-17095734497174714-24" aria-expanded="false">Functions<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-24" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-23" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_j.html#index_j">j</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_k.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_q.html#index_q">q</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_r.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_u.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_v.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_w.html#index_w">w</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_x.html#index_x">x</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_z.html#index_z">z</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_func_~.html#index__7E">~</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars.html" class="has-submenu" id="sm-17095734497174714-25" aria-haspopup="true" aria-controls="sm-17095734497174714-26" aria-expanded="false">Variables<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-26" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-25" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars.html#index__5F">_</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_a.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_j.html#index_j">j</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_k.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_q.html#index_q">q</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_r.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_u.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_v.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_w.html#index_w">w</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_x.html#index_x">x</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_y.html#index_y">y</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_vars_z.html#index_z">z</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type.html" class="has-submenu" id="sm-17095734497174714-27" aria-haspopup="true" aria-controls="sm-17095734497174714-28" aria-expanded="false">Typedefs<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-28" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-27" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_j.html#index_j">j</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_k.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_q.html#index_q">q</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_r.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_v.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_w.html#index_w">w</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_type_z.html#index_z">z</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html" class="has-submenu" id="sm-17095734497174714-29" aria-haspopup="true" aria-controls="sm-17095734497174714-30" aria-expanded="false">Enumerations<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-30" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-29" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_enum.html#index_w">w</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval.html" class="has-submenu" id="sm-17095734497174714-31" aria-haspopup="true" aria-controls="sm-17095734497174714-32" aria-expanded="false">Enumerator<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-32" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-31" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_j.html#index_j">j</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_k.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_q.html#index_q">q</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_r.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_u.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_v.html#index_v">v</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_w.html#index_w">w</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_eval_x.html#index_x">x</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela.html" class="has-submenu" id="sm-17095734497174714-33" aria-haspopup="true" aria-controls="sm-17095734497174714-34" aria-expanded="false">Related Symbols<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-34" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-33" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela.html#index_:">:</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_a.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_r.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_u.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/functions_rela_v.html#index_v">v</a></li></ul></li></ul></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/pages.html">Related Pages</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/files.html" class="has-submenu" id="sm-17095734497174714-35" aria-haspopup="true" aria-controls="sm-17095734497174714-36" aria-expanded="false">Files<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-36" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-35" aria-expanded="false" class="sm-nowrap" style="width: auto; min-width: 10em; display: none; max-width: 20em; top: auto; left: 0px; margin-left: 0px; margin-top: 0px;"><li><a href="https://www.dealii.org/current/doxygen/deal.II/files.html">File List</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals.html" class="has-submenu" id="sm-17095734497174714-37" aria-haspopup="true" aria-controls="sm-17095734497174714-38" aria-expanded="false">File Members<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-38" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-37" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals.html" class="has-submenu" id="sm-17095734497174714-39" aria-haspopup="true" aria-controls="sm-17095734497174714-40" aria-expanded="false">All<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-40" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-39" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_k.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_r.html#index_r">r</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_u.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_v.html#index_v">v</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func.html" class="has-submenu" id="sm-17095734497174714-41" aria-haspopup="true" aria-controls="sm-17095734497174714-42" aria-expanded="false">Functions<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-42" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-41" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_c.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_g.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_l.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_n.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_o.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_t.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_u.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_func_v.html#index_v">v</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html" class="has-submenu" id="sm-17095734497174714-43" aria-haspopup="true" aria-controls="sm-17095734497174714-44" aria-expanded="false">Variables<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-44" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-43" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_c">c</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_g">g</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_k">k</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_l">l</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_n">n</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_o">o</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_t">t</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_u">u</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_vars.html#index_v">v</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_type.html">Typedefs</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_enum.html">Enumerations</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_eval.html" class="has-submenu" id="sm-17095734497174714-45" aria-haspopup="true" aria-controls="sm-17095734497174714-46" aria-expanded="false">Enumerator<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-46" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-45" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_eval.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_eval.html#index_u">u</a></li></ul></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs.html" class="has-submenu" id="sm-17095734497174714-47" aria-haspopup="true" aria-controls="sm-17095734497174714-48" aria-expanded="false">Macros<span class="sub-arrow"></span></a><ul id="sm-17095734497174714-48" role="group" aria-hidden="true" aria-labelledby="sm-17095734497174714-47" aria-expanded="false"><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs.html#index_a">a</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_b.html#index_b">b</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_d.html#index_d">d</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_e.html#index_e">e</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_f.html#index_f">f</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_h.html#index_h">h</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_i.html#index_i">i</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_m.html#index_m">m</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_p.html#index_p">p</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_s.html#index_s">s</a></li><li><a href="https://www.dealii.org/current/doxygen/deal.II/globals_defs_t.html#index_t">t</a></li></ul></li></ul></li></ul></li><li><a href="http://www.dealii.org/">dealii.org</a></li><li id="searchBoxPos2" style="float:right"><div id="MSearchBox" class="MSearchBoxInactive"><span class="left"><span id="MSearchSelect" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()">&nbsp;</span><input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)"></span><span class="right"><a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()" style="display: none;"><img id="MSearchCloseImg" border="0" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/close.svg" alt=""></a></span></div></li></ul></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" onclick="searchBox.OnSelectItem(0)" href="javascript:void(0)"><span class="SelectionMark"></span>All</a><a class="SelectItem" onclick="searchBox.OnSelectItem(1)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" onclick="searchBox.OnSelectItem(2)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" onclick="searchBox.OnSelectItem(3)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" onclick="searchBox.OnSelectItem(4)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" onclick="searchBox.OnSelectItem(5)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" onclick="searchBox.OnSelectItem(6)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" onclick="searchBox.OnSelectItem(7)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" onclick="searchBox.OnSelectItem(8)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" onclick="searchBox.OnSelectItem(9)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" onclick="searchBox.OnSelectItem(10)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Macros</a><a class="SelectItem" onclick="searchBox.OnSelectItem(11)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Modules</a><a class="SelectItem" onclick="searchBox.OnSelectItem(12)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Pages</a><a class="SelectItem" onclick="searchBox.OnSelectItem(13)" href="javascript:void(0)"><span class="SelectionMark">&nbsp;</span>Concepts</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow" style="display: none;">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">The 'Quasi-Static Finite-Strain Compressible Elasticity' code gallery program</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p> 
</p><p align="center"> 
  This program was contributed by Jean-Paul Pelteret &lt;jppelteret@gmail.com&gt;.
  <br>
  It comes without any warranty or support by its authors or the authors of deal.II.
</p>

<p></p>
<p>This program is part of the <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/CodeGallery.html">deal.II code gallery</a> and consists of the following files (click to inspect):</p><ul>
<li><a href="https://www.dealii.org/current/doxygen/code-gallery/Quasi_static_Finite_strain_Compressible_Elasticity/README.md">README.md</a> (<a href="https://www.dealii.org/current/doxygen/deal.II/code_gallery_Quasi_static_Finite_strain_Compressible_Elasticity.html#ann-README.md">annotated version</a>)</li>
<li><a href="https://www.dealii.org/current/doxygen/code-gallery/Quasi_static_Finite_strain_Compressible_Elasticity/CMakeLists.txt">CMakeLists.txt</a></li>
<li><a href="https://www.dealii.org/current/doxygen/code-gallery/Quasi_static_Finite_strain_Compressible_Elasticity/cook_membrane.cc">cook_membrane.cc</a> (<a href="https://www.dealii.org/current/doxygen/deal.II/code_gallery_Quasi_static_Finite_strain_Compressible_Elasticity.html#ann-cook_membrane.cc">annotated version</a>)</li>
<li><a href="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/disp_soln.png">doc/disp_soln.png</a></li>
<li><a href="https://www.dealii.org/current/doxygen/code-gallery/Quasi_static_Finite_strain_Compressible_Elasticity/doc/entry-name">doc/entry-name</a></li>
<li><a href="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/problem_setup.png">doc/problem_setup.png</a></li>
<li><a href="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/ref_grid.png">doc/ref_grid.png</a></li>
<li><a href="https://www.dealii.org/current/doxygen/code-gallery/Quasi_static_Finite_strain_Compressible_Elasticity/parameters.prm">parameters.prm</a></li>
</ul>
<h1>Pictures from this code gallery program</h1>
<p align="center"></p>
<table class="doxtable">
<tbody><tr>
<td><img src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/ref_grid.png" alt="" width="250" class="inline">  </td><td><img src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/problem_setup.png" alt="" width="250" class="inline">  </td><td><img src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/disp_soln.png" alt="" width="250" class="inline">   </td></tr>
</tbody></table>
<p><a class="anchor" id="ann-README.md"></a> </p><h1>Annotated version of README.md</h1>
<h2><a class="anchor" id="autotoc_md102"></a>
Overview</h2>
<p>The Cook membrane (or cantilever) problem is a classic benchmark test for finite element formulations for solid mechanics. It is typically used to test for and demonstrate the shear-locking (or locking-free) behaviour of a finite element ansatz under quasi-incompressible conditions. As it is so widely referred to in the literature on finite-strain elasticity, we reproduce the example here. However, we consider on the compressible case to avoid many of the complexities that arise in <code>@ref step_44 "step-44"</code>, which provides an efficient approach to deal with the quasi-incompressible case.</p>
<h3><a class="anchor" id="autotoc_md103"></a>
A classical approach to solving the cook membrane problem.</h3>
<p>In this work we take a classical approach to solving the equations governing quasi-static finite-strain compressible elasticity, with code based on <code>@ref step_44 "step-44"</code>. The formulation adopted here is that seen in many texts on solid mechanics and can be used as the starting point for extension into many topics such as material anisotropy, rate dependence or plasticity, or even as a component of multi-physics problems.</p>
<p>The basic problem configuration is summarised in the following image. A beam of specific dimensions is fixed at one end and a uniform traction load is applied at the other end such that the total force acting on this surface totals 1 Newton. Displacement in the third coordinate direction (out of plane) is prevented in order to impose plane strain conditions.</p>
<p><img src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/problem_setup.png" alt="Problem geometry" class="inline"></p>
<p>Note that we perform a three-dimensional computation as, for this particular formulation, the two-dimensional case corresponds to neither plane-strain nor plane-stress conditions.</p>
<h2><a class="anchor" id="autotoc_md104"></a>
Compiling and running</h2>
<p>Similar to the example programs, run </p><div class="fragment"><div class="line">cmake -DDEAL_II_DIR=/path/to/deal.II .</div>
</div><!-- fragment --><p> in this directory to configure the problem. <br>
 You can switch between debug and release mode by calling either </p><div class="fragment"><div class="line">make debug</div>
</div><!-- fragment --><p> or </p><div class="fragment"><div class="line">make release</div>
</div><!-- fragment --><p> The problem may then be run with </p><div class="fragment"><div class="line">make run</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md105"></a>
Reference for this work</h2>
<p>If you use this program as a basis for your own work, please consider citing it in your list of references. The initial version of this work was contributed to the deal.II project by the authors listed in the following citation: J-P. V. Pelteret and A. McBride, The deal.II code gallery: Quasi-Static Finite-Strain Compressible Elasticity, 2016. DOI: <a href="http://doi.org/10.5281/zenodo.1228964">10.5281/zenodo.1228964</a> <img src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/zenodo.1228964.svg" alt="" style="pointer-events: none; float: right;" class="inline"></p>
<h3><a class="anchor" id="autotoc_md106"></a>
Acknowledgements</h3>
<p>The support of this work by the European Research Council (ERC) through the Advanced Grant 289049 MOCOPOLY is gratefully acknowledged by the first author.</p>
<h2><a class="anchor" id="autotoc_md109"></a>
Recommended Literature</h2>
<p>C. Miehe (1994), Aspects of the formulation and finite element implementation of large strain isotropic elasticity International Journal for Numerical Methods in Engineering 37 , 12, 1981-2004. DOI: <a href="http://doi.org/10.1002/nme.1620371202">10.1002/nme.1620371202</a>; G.A. Holzapfel (2001), Nonlinear Solid Mechanics. A Continuum Approach for Engineering, John Wiley &amp; Sons. ISBN: <a href="http://eu.wiley.com/WileyCDA/WileyTitle/productCd-0471823198.html">978-0-471-82319-3</a>; P. Wriggers (2008), Nonlinear finite element methods, Springer. DOI: <a href="http://doi.org/10.1007/978-3-540-71001-1">10.1007/978-3-540-71001-1</a>; T.J.R. Hughes (2000), The Finite Element Method: Linear Static and Dynamic Finite Element Analysis, Dover. ISBN: <a href="http://store.doverpublications.com/0486411818.html">978-0486411811</a></p>
<p>The derivation of the finite-element problem, namely the definition and linearisation of the residual and their subsequent discretisation are quite lengthy and involved. Thankfully, the classical approach adopted in this work is well documented and therefore does not need to be reproduced here. We refer the reader to, among many other possible texts, Holzapfel (2001) and Wriggers (2008) for a detailed description of the approach applied in this work. It amounts to a reduction and slight reworking of <code>@ref step_44 "step-44"</code> (accounting for the removal of the two additional fields used therein). We also refer the reader to <code>@ref step_44 "step-44"</code> for a brief overview of the continuum mechanics and kinematics related to solid mechanics. We also provide two alternative assembly mechanisms, which can be selected within the parameter file, that use automatic differentiation to assemble the linear system. These not only demonstrate how one might employ such automated techniques to linearise the residual, but also serve as a verification of the correctness of the hand-developed implementation of the tangent stiffness matrix.</p>
<h2><a class="anchor" id="autotoc_md116"></a>
Results</h2>
<p>These results were produced using the following material properties: Shear modulus is 422.5kPa Poisson ratio is 0.3</p>
<p>The 32x32x1 discretised reference geometry looks as follows:</p>
<p><img src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/ref_grid.png" alt="Problem geometry" class="inline"></p>
<p>And an example of the displaced solution is given in the next image.</p>
<p><img src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/disp_soln.png" alt="Displaced solution" class="inline"></p>
<p>Below we briefly document the tip displacement as predicted for different discretisation levels and ansatz for the displacement field. A direct and, by visual inspection, favourable comparison of the following results can be made with those found in Miehe (1994). Specifically, figure 5 of Miehe (1994) plots the vertical displacement at the midway point on the traction surface for the compressible 3d case. Since the material is compressible, shear-locking is not exhibited by the beam for low-order elements.</p>
<h4><a class="anchor" id="autotoc_md121"></a>
Number of degrees of freedom</h4>
<table class="markdownTable">
<tbody><tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Elements per edge   </th><th class="markdownTableHeadCenter">Q1   </th><th class="markdownTableHeadCenter">Q2    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">2   </td><td class="markdownTableBodyCenter">54   </td><td class="markdownTableBodyCenter">225    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">4   </td><td class="markdownTableBodyCenter">150   </td><td class="markdownTableBodyCenter">729    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter">486   </td><td class="markdownTableBodyCenter">2601    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">16   </td><td class="markdownTableBodyCenter">1734   </td><td class="markdownTableBodyCenter">9801    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">32   </td><td class="markdownTableBodyCenter">6534   </td><td class="markdownTableBodyCenter">38025    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">64   </td><td class="markdownTableBodyCenter">25350   </td><td class="markdownTableBodyCenter">149769   </td></tr>
</tbody></table>
<h4><a class="anchor" id="autotoc_md123"></a>
Tip y-displacement (in mm)</h4>
<table class="markdownTable">
<tbody><tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Elements per edge   </th><th class="markdownTableHeadCenter">Q1   </th><th class="markdownTableHeadCenter">Q2    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">2   </td><td class="markdownTableBodyCenter">8.638   </td><td class="markdownTableBodyCenter">14.30    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">4   </td><td class="markdownTableBodyCenter">12.07   </td><td class="markdownTableBodyCenter">14.65    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">8   </td><td class="markdownTableBodyCenter">13.86   </td><td class="markdownTableBodyCenter">14.71    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">16   </td><td class="markdownTableBodyCenter">14.49   </td><td class="markdownTableBodyCenter">14.73    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">32   </td><td class="markdownTableBodyCenter">14.67   </td><td class="markdownTableBodyCenter">14.74    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">64   </td><td class="markdownTableBodyCenter">14.72   </td><td class="markdownTableBodyCenter">14.74   </td></tr>
</tbody></table>
<p><a class="anchor" id="ann-cook_membrane.cc"></a> </p><h1>Annotated version of cook_membrane.cc</h1>
<div class="fragment"><div class="line">&nbsp; <span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">&nbsp;  * Copyright (C) 2010 - 2015 by the deal.II authors and</span></div>
<div class="line"><span class="comment">&nbsp;  *                              Jean-Paul Pelteret and Andrew McBride</span></div>
<div class="line"><span class="comment">&nbsp;  *</span></div>
<div class="line"><span class="comment">&nbsp;  * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment">&nbsp;  *</span></div>
<div class="line"><span class="comment">&nbsp;  * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment">&nbsp;  * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment">&nbsp;  * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment">&nbsp;  * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment">&nbsp;  * The full text of the license can be found in the file LICENSE at</span></div>
<div class="line"><span class="comment">&nbsp;  * the top level of the deal.II distribution.</span></div>
<div class="line"><span class="comment">&nbsp;  *</span></div>
<div class="line"><span class="comment">&nbsp;  * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">&nbsp;  */</span></div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; <span class="comment">/*</span></div>
<div class="line"><span class="comment">&nbsp;  * Authors: Jean-Paul Pelteret, University of Erlangen-Nuremberg,</span></div>
<div class="line"><span class="comment">&nbsp;  *          Andrew McBride, University of Cape Town, 2015, 2017</span></div>
<div class="line"><span class="comment">&nbsp;  */</span></div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We start by including all the necessary deal.II header files and some C++ related ones. They have been discussed in detail in previous tutorial programs, so you need only refer to past tutorials for details.</p>
<div class="fragment"><div class="line">&nbsp; #include &lt;deal.II/base/function.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/base/parameter_handler.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/base/point.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/base/quadrature_lib.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/base/symmetric_tensor.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/base/tensor.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/base/timer.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/base/work_stream.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/base/quadrature_point_data.h&gt;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; #include &lt;deal.II/dofs/dof_renumbering.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/dofs/dof_tools.h&gt;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; #include &lt;deal.II/grid/grid_generator.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/grid/grid_tools.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/grid/grid_in.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/grid/<a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/tria__description_8cc.html#ab695339a227bd369fcea767631247cff">tria</a>.h&gt;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; #include &lt;deal.II/fe/fe_dgp_monomial.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/fe/fe_q.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/fe/fe_system.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/fe/fe_tools.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/fe/fe_values.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/fe/mapping_q_eulerian.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/fe/mapping_q.h&gt;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; #include &lt;deal.II/lac/affine_constraints.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/lac/block_sparse_matrix.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/lac/block_vector.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/lac/dynamic_sparsity_pattern.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/lac/full_matrix.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/lac/precondition_selector.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/lac/solver_cg.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/lac/sparse_direct.h&gt;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; #include &lt;deal.II/numerics/data_out.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/numerics/vector_tools.h&gt;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; #include &lt;deal.II/base/config.h&gt;</div>
<div class="line">&nbsp; #<span class="keywordflow">if</span> <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/config_8h.html#af10cd3eafab58df1ea4840bd58fbddaf">DEAL_II_VERSION_MAJOR</a> &gt;= 9 &amp;&amp; defined(DEAL_II_WITH_TRILINOS)</div>
<div class="line">&nbsp; <span class="preprocessor">#include &lt;deal.II/differentiation/ad.h&gt;</span></div>
<div class="line">&nbsp; #define ENABLE_SACADO_FORMULATION</div>
<div class="line">&nbsp; #endif</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aconfig_8h_html_af10cd3eafab58df1ea4840bd58fbddaf"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/config_8h.html#af10cd3eafab58df1ea4840bd58fbddaf">DEAL_II_VERSION_MAJOR</a></div><div class="ttdeci">#define DEAL_II_VERSION_MAJOR</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/config_8h_source.html#l00028">config.h:28</a></div></div>
<div class="ttc" id="atria__description_8cc_html_ab695339a227bd369fcea767631247cff"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/tria__description_8cc.html#ab695339a227bd369fcea767631247cff">tria</a></div><div class="ttdeci">const ::Triangulation&lt; dim, spacedim &gt; &amp; tria</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/tria__description_8cc_source.html#l00704">tria_description.cc:704</a></div></div>
</div><!-- fragment --><p>These must be included below the AD headers so that their math functions are available for use in the definition of tensors and kinematic quantities</p>
<div class="fragment"><div class="line">&nbsp; #include &lt;deal.II/physics/elasticity/kinematics.h&gt;</div>
<div class="line">&nbsp; #include &lt;deal.II/physics/elasticity/standard_tensors.h&gt;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; #include &lt;iostream&gt;</div>
<div class="line">&nbsp; #include &lt;fstream&gt;</div>
<div class="line">&nbsp; #include &lt;memory&gt;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We then stick everything that relates to this tutorial program into a namespace of its own, and import all the deal.II function and class names into it:</p>
<div class="fragment"><div class="line">&nbsp; <span class="keyword">namespace </span>Cook_Membrane</div>
<div class="line">&nbsp; {</div>
<div class="line">&nbsp;   <span class="keyword">using namespace </span><a class="code hl_namespace" href="https://www.dealii.org/current/doxygen/deal.II/namespacedealii.html">dealii</a>;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="anamespacedealii_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/namespace__dealii_8h_source.html#l00025">namespace_dealii.h:26</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Runtimeparameters"></a> </p><h3>Run-time parameters</h3>
<p>There are several parameters that can be set in the code so we set up a <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> object to read in the choices at run-time.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">namespace </span>Parameters</div>
<div class="line">&nbsp;   {</div>
</div><!-- fragment --><p><a class="anchor" id="Assemblymethod"></a> </p><h4>Assembly method</h4>
<p>Here we specify whether automatic differentiation is to be used to assemble the linear system, and if so then what order of differentiation is to be employed.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>AssemblyMethod</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> automatic_differentiation_order;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> AssemblyMethod::declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Assembly method"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Automatic differentiation order"</span>, <span class="stringliteral">"0"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Integer.html">Patterns::Integer</a>(0,2),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"The automatic differentiation order to be used in the assembly of the linear system.\n"</span></div>
<div class="line">&nbsp;                           <span class="stringliteral">"# Order = 0: Both the residual and linearisation are computed manually.\n"</span></div>
<div class="line">&nbsp;                           <span class="stringliteral">"# Order = 1: The residual is computed manually but the linearisation is performed using AD.\n"</span></div>
<div class="line">&nbsp;                           <span class="stringliteral">"# Order = 2: Both the residual and linearisation are computed using AD."</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> AssemblyMethod::parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Assembly method"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         automatic_differentiation_order = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">"Automatic differentiation order"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassParameterHandler_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/parameter__handler_8h_source.html#l00855">parameter_handler.h:856</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a599462cacd492e2f712bf7369507dcff"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">ParameterHandler::leave_subsection</a></div><div class="ttdeci">void leave_subsection()</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/parameter__handler_8cc_source.html#l00986">parameter_handler.cc:986</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a61fa98fdc0c52980a5b1de0ee1fc5bb2"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">ParameterHandler::get_integer</a></div><div class="ttdeci">long int get_integer(const std::string &amp;entry_string) const</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/parameter__handler_8cc_source.html#l01058">parameter_handler.cc:1058</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a6d65f458be69e23a348221cb67fc411d"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">ParameterHandler::declare_entry</a></div><div class="ttdeci">void declare_entry(const std::string &amp;entry, const std::string &amp;default_value, const Patterns::PatternBase &amp;pattern=Patterns::Anything(), const std::string &amp;documentation="", const bool has_to_be_set=false)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/parameter__handler_8cc_source.html#l00827">parameter_handler.cc:827</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_af29c20cde6d44186806d559beb468696"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">ParameterHandler::enter_subsection</a></div><div class="ttdeci">void enter_subsection(const std::string &amp;subsection)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/parameter__handler_8cc_source.html#l00972">parameter_handler.cc:972</a></div></div>
<div class="ttc" id="aclassPatterns_1_1Integer_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Integer.html">Patterns::Integer</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/patterns_8h_source.html#l00188">patterns.h:189</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="FiniteElementsystem"></a> </p><h4>Finite Element system</h4>
<p>Here we specify the polynomial order used to approximate the solution. The quadrature order should be adjusted accordingly.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span><a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFESystem.html">FESystem</a></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> poly_degree;</div>
<div class="line">&nbsp;       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quad_order;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> FESystem::declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Finite element system"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Polynomial degree"</span>, <span class="stringliteral">"2"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Integer.html">Patterns::Integer</a>(0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Displacement system polynomial order"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Quadrature order"</span>, <span class="stringliteral">"3"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Integer.html">Patterns::Integer</a>(0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Gauss quadrature order"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> FESystem::parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Finite element system"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         poly_degree = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">"Polynomial degree"</span>);</div>
<div class="line">&nbsp;         quad_order = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">"Quadrature order"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassFESystem_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classFESystem.html">FESystem</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe__system_8h_source.html#l00208">fe_system.h:209</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Geometry"></a> </p><h4>Geometry</h4>
<p>Make adjustments to the problem geometry and its discretisation.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>Geometry</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elements_per_edge;</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span>       scale;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> Geometry::declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Geometry"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Elements per edge"</span>, <span class="stringliteral">"32"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Integer.html">Patterns::Integer</a>(0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Number of elements per long edge of the beam"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Grid scale"</span>, <span class="stringliteral">"1e-3"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(0.0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Global grid scaling factor"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> Geometry::parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Geometry"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         elements_per_edge = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">"Elements per edge"</span>);</div>
<div class="line">&nbsp;         <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridTools.html#a0967563badadd81f77f62622dd8bc2cd">scale</a> = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"Grid scale"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassParameterHandler_html_aeaf3c7846747695b1f327677e3716ec5"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">ParameterHandler::get_double</a></div><div class="ttdeci">double get_double(const std::string &amp;entry_name) const</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/parameter__handler_8cc_source.html#l01101">parameter_handler.cc:1101</a></div></div>
<div class="ttc" id="aclassPatterns_1_1Double_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/patterns_8h_source.html#l00291">patterns.h:292</a></div></div>
<div class="ttc" id="anamespaceGridTools_html_a0967563badadd81f77f62622dd8bc2cd"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridTools.html#a0967563badadd81f77f62622dd8bc2cd">GridTools::scale</a></div><div class="ttdeci">void scale(const double scaling_factor, Triangulation&lt; dim, spacedim &gt; &amp;triangulation)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/grid__tools_8cc_source.html#l02202">grid_tools.cc:2202</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Materials"></a> </p><h4>Materials</h4>
<p>We also need the shear modulus <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-9" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1000.6em, 2.384em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5"> \mu </script> and Poisson ration <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-12" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1000.54em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6"> \nu </script> for the neo-Hookean material.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>Materials</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span> nu;</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span> mu;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> Materials::declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Material properties"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Poisson's ratio"</span>, <span class="stringliteral">"0.3"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(-1.0,0.5),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Poisson's ratio"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Shear modulus"</span>, <span class="stringliteral">"0.4225e6"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Shear modulus"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> Materials::parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Material properties"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         nu = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"Poisson's ratio"</span>);</div>
<div class="line">&nbsp;         mu = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"Shear modulus"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Linearsolver"></a> </p><h4>Linear solver</h4>
<p>Next, we choose both solver and preconditioner settings. The use of an effective preconditioner is critical to ensure convergence when a large nonlinear motion occurs within a Newton increment.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>LinearSolver</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       std::string type_lin;</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span>      tol_lin;</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span>      max_iterations_lin;</div>
<div class="line">&nbsp;       std::string preconditioner_type;</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span>      preconditioner_relaxation;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> LinearSolver::declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Linear solver"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Solver type"</span>, <span class="stringliteral">"CG"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Selection.html">Patterns::Selection</a>(<span class="stringliteral">"CG|Direct"</span>),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Type of solver used to solve the linear system"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Residual"</span>, <span class="stringliteral">"1e-6"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(0.0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Linear solver residual (scaled by residual norm)"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Max iteration multiplier"</span>, <span class="stringliteral">"1"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(0.0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Linear solver iterations (multiples of the system matrix size)"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Preconditioner type"</span>, <span class="stringliteral">"ssor"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Selection.html">Patterns::Selection</a>(<span class="stringliteral">"jacobi|ssor"</span>),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Type of preconditioner"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Preconditioner relaxation"</span>, <span class="stringliteral">"0.65"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(0.0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Preconditioner relaxation value"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> LinearSolver::parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Linear solver"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         type_lin = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a>(<span class="stringliteral">"Solver type"</span>);</div>
<div class="line">&nbsp;         tol_lin = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"Residual"</span>);</div>
<div class="line">&nbsp;         max_iterations_lin = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"Max iteration multiplier"</span>);</div>
<div class="line">&nbsp;         preconditioner_type = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a>(<span class="stringliteral">"Preconditioner type"</span>);</div>
<div class="line">&nbsp;         preconditioner_relaxation = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"Preconditioner relaxation"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassParameterHandler_html_a91cfbaca954f444047302446a4e87125"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a91cfbaca954f444047302446a4e87125">ParameterHandler::get</a></div><div class="ttdeci">std::string get(const std::string &amp;entry_string) const</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/parameter__handler_8cc_source.html#l01020">parameter_handler.cc:1020</a></div></div>
<div class="ttc" id="aclassPatterns_1_1Selection_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Selection.html">Patterns::Selection</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/patterns_8h_source.html#l00381">patterns.h:382</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Nonlinearsolver"></a> </p><h4>Nonlinear solver</h4>
<p>A Newton-Raphson scheme is used to solve the nonlinear system of governing equations. We now define the tolerances and the maximum number of iterations for the Newton-Raphson nonlinear solver.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>NonlinearSolver</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_iterations_NR;</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span>       tol_f;</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span>       tol_u;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> NonlinearSolver::declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Nonlinear solver"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Max iterations Newton-Raphson"</span>, <span class="stringliteral">"10"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Integer.html">Patterns::Integer</a>(0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Number of Newton-Raphson iterations allowed"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Tolerance force"</span>, <span class="stringliteral">"1.0e-9"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(0.0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Force residual tolerance"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Tolerance displacement"</span>, <span class="stringliteral">"1.0e-6"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(0.0),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Displacement error tolerance"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> NonlinearSolver::parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Nonlinear solver"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         max_iterations_NR = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">"Max iterations Newton-Raphson"</span>);</div>
<div class="line">&nbsp;         tol_f = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"Tolerance force"</span>);</div>
<div class="line">&nbsp;         tol_u = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"Tolerance displacement"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Time"></a> </p><h4>Time</h4>
<p>Set the timestep size <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-15" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1001.13em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;"></span><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7"> \varDelta t </script> and the simulation end-time.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>Time</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span> delta_t;</div>
<div class="line">&nbsp;       <span class="keywordtype">double</span> end_time;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> Time::declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Time"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"End time"</span>, <span class="stringliteral">"1"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"End time"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">"Time step size"</span>, <span class="stringliteral">"0.1"</span>,</div>
<div class="line">&nbsp;                           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPatterns_1_1Double.html">Patterns::Double</a>(),</div>
<div class="line">&nbsp;                           <span class="stringliteral">"Time step size"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> Time::parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">"Time"</span>);</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         end_time = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"End time"</span>);</div>
<div class="line">&nbsp;         delta_t = prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">"Time step size"</span>);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       prm.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Allparameters"></a> </p><h4>All parameters</h4>
<p>Finally we consolidate all of the above structures into a single container that holds all of our run-time selections.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>AllParameters :</div>
<div class="line">&nbsp;       <span class="keyword">public</span> AssemblyMethod,</div>
<div class="line">&nbsp;       <span class="keyword">public</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFESystem.html">FESystem</a>,</div>
<div class="line">&nbsp;       <span class="keyword">public</span> Geometry,</div>
<div class="line">&nbsp;       <span class="keyword">public</span> Materials,</div>
<div class="line">&nbsp;       <span class="keyword">public</span> LinearSolver,</div>
<div class="line">&nbsp;       <span class="keyword">public</span> NonlinearSolver,</div>
<div class="line">&nbsp;       <span class="keyword">public</span> Time</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       AllParameters(<span class="keyword">const</span> std::string &amp;input_file);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">void</span></div>
<div class="line">&nbsp;       parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm);</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     AllParameters::AllParameters(<span class="keyword">const</span> std::string &amp;input_file)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> prm;</div>
<div class="line">&nbsp;       declare_parameters(prm);</div>
<div class="line">&nbsp;       prm.parse_input(input_file);</div>
<div class="line">&nbsp;       parse_parameters(prm);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> AllParameters::declare_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       AssemblyMethod::declare_parameters(prm);</div>
<div class="line">&nbsp;       FESystem::declare_parameters(prm);</div>
<div class="line">&nbsp;       Geometry::declare_parameters(prm);</div>
<div class="line">&nbsp;       Materials::declare_parameters(prm);</div>
<div class="line">&nbsp;       LinearSolver::declare_parameters(prm);</div>
<div class="line">&nbsp;       NonlinearSolver::declare_parameters(prm);</div>
<div class="line">&nbsp;       Time::declare_parameters(prm);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> AllParameters::parse_parameters(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classParameterHandler.html">ParameterHandler</a> &amp;prm)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       AssemblyMethod::parse_parameters(prm);</div>
<div class="line">&nbsp;       FESystem::parse_parameters(prm);</div>
<div class="line">&nbsp;       Geometry::parse_parameters(prm);</div>
<div class="line">&nbsp;       Materials::parse_parameters(prm);</div>
<div class="line">&nbsp;       LinearSolver::parse_parameters(prm);</div>
<div class="line">&nbsp;       NonlinearSolver::parse_parameters(prm);</div>
<div class="line">&nbsp;       Time::parse_parameters(prm);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Timeclass"></a> </p><h3>Time class</h3>
<p>A simple class to store time data. Its functioning is transparent so no discussion is necessary. For simplicity we assume a constant time step size.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">class </span>Time</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;   <span class="keyword">public</span>:</div>
<div class="line">&nbsp;     Time (<span class="keyword">const</span> <span class="keywordtype">double</span> time_end,</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <span class="keywordtype">double</span> delta_t)</div>
<div class="line">&nbsp;       :</div>
<div class="line">&nbsp;       timestep(0),</div>
<div class="line">&nbsp;       time_current(0.0),</div>
<div class="line">&nbsp;       time_end(time_end),</div>
<div class="line">&nbsp;       delta_t(delta_t)</div>
<div class="line">&nbsp;     {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     virtual ~Time()</div>
<div class="line">&nbsp;     {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     double current() const</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       return time_current;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp;     <span class="keywordtype">double</span> end() const</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> time_end;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp;     <span class="keywordtype">double</span> get_delta_t() const</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> delta_t;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp;     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> get_timestep() const</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> timestep;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp;     <span class="keywordtype">void</span> increment()</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       time_current += delta_t;</div>
<div class="line">&nbsp;       ++timestep;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">private</span>:</div>
<div class="line">&nbsp;     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep;</div>
<div class="line">&nbsp;     <span class="keywordtype">double</span>       time_current;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> time_end;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> delta_t;</div>
<div class="line">&nbsp;   };</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="CompressibleneoHookeanmaterialwithinaonefieldformulation"></a> </p><h3>Compressible neo-Hookean material within a one-field formulation</h3>
<p>As discussed in the literature and <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/step_44.html">step-44</a>, Neo-Hookean materials are a type of hyperelastic materials. The entire domain is assumed to be composed of a compressible neo-Hookean material. This class defines the behaviour of this material within a one-field formulation. Compressible neo-Hookean materials can be described by a strain-energy function (SEF) <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-19" style="width: 11.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.705em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1009.59em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-23" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.777em;"><span class="texatom" id="MathJax-Span-25"><span class="mrow" id="MathJax-Span-26"><span class="mtext" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Main;">iso</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-29"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-30"><span class="mrow" id="MathJax-Span-31"><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Main-bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1000.6em, 3.812em, -999.997em); top: -4.521em; left: 0.003em;"><span class="mo" id="MathJax-Span-33" style=""><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; top: -3.985em; left: -0.057em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.301em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.122em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-36" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.777em;"><span class="texatom" id="MathJax-Span-38"><span class="mrow" id="MathJax-Span-39"><span class="mtext" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Main;">vol</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8"> \Psi =
   \Psi_{\text{iso}}(\overline{\mathbf{b}}) + \Psi_{\text{vol}}(J)
   </script>.</p>
<p>The isochoric response is given by <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-44" style="width: 10.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.634em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1008.51em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-45"><span class="msubsup" id="MathJax-Span-46"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.777em;"><span class="texatom" id="MathJax-Span-48"><span class="mrow" id="MathJax-Span-49"><span class="mtext" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Main;">iso</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-53"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Main-bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1000.6em, 3.812em, -999.997em); top: -4.521em; left: 0.003em;"><span class="mo" id="MathJax-Span-56" style=""><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; top: -3.985em; left: -0.057em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.301em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.122em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-59" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-61"><span class="mrow" id="MathJax-Span-62"><span class="mn" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-65"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="munderover" id="MathJax-Span-66"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1000.48em, 3.812em, -999.997em); top: -4.461em; left: 0.063em;"><span class="mo" id="MathJax-Span-68" style=""><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; top: -3.985em; left: -0.057em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.182em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.063em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-69"><span class="mrow" id="MathJax-Span-70"><span class="mn" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.241em;"></span><span class="mn" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.241em;">3</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">
   \Psi_{\text{iso}}(\overline{\mathbf{b}}) = c_{1} [\overline{I}_{1} - 3] </script> where <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-75" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.979em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1002.98em, 2.801em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-76"><span class="msubsup" id="MathJax-Span-77"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-79"><span class="mrow" id="MathJax-Span-80"><span class="mn" id="MathJax-Span-81" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-83" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.515em, 1000.42em, 4.348em, -999.997em); top: -4.58em; left: 50%; margin-left: -0.235em;"><span class="mi" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.176em;"><span class="mn" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.54em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.539em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10"> c_{1} = \frac{\mu}{2} </script> and <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-86" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-0.176em, 1001.01em, 1.372em, -999.997em); top: -1.009em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="munderover" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1000.48em, 3.812em, -999.997em); top: -4.461em; left: 0.063em;"><span class="mo" id="MathJax-Span-91" style=""><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; top: -3.985em; left: -0.057em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.182em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.063em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="mn" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\overline{I}_{1}</script> is the first invariant of the left- or right-isochoric Cauchy-Green deformation tensors. That is <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-95" style="width: 5.896em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.884em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.015em, 1004.76em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-96"><span class="msubsup" id="MathJax-Span-97"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="munderover" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.48em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1000.48em, 3.812em, -999.997em); top: -4.461em; left: 0.063em;"><span class="mo" id="MathJax-Span-100" style=""><span style="display: inline-block; position: relative; width: 0.479em; height: 0px;"><span style="position: absolute; top: -3.985em; left: -0.057em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.182em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.063em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mn" id="MathJax-Span-101" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main; padding-left: 0.301em;">:<span style="font-family: MathJax_Main;">=</span></span><span class="texatom" id="MathJax-Span-103" style="padding-left: 0.301em;"><span class="mrow" id="MathJax-Span-104"><span class="mtext" id="MathJax-Span-105" style="font-family: MathJax_Main;">tr</span></span></span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Main-bold;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1000.6em, 3.812em, -999.997em); top: -4.521em; left: 0.003em;"><span class="mo" id="MathJax-Span-111" style=""><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; top: -3.985em; left: -0.057em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.301em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.122em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\overline{I}_1 :=\textrm{tr}(\overline{\mathbf{b}})</script>. In this example the SEF that governs the volumetric response is defined as <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-113" style="width: 15.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.801em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1012.68em, 2.801em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-114"><span class="msubsup" id="MathJax-Span-115"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.777em;"><span class="texatom" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="mtext" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Main;">vol</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic; padding-left: 0.301em;"></span><span class="mfrac" id="MathJax-Span-125"><span style="display: inline-block; position: relative; width: 0.479em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -4.402em; left: 50%; margin-left: -0.176em;"><span class="mn" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.17em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.176em;"><span class="mn" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.48em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.479em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-129"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.717em;"><span class="mn" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.241em;"></span><span class="mn" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.241em;">1</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.241em;"></span><span class="mn" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.241em;">2</span><span class="texatom" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mtext" id="MathJax-Span-138" style="font-family: MathJax_Main;">ln</span></span></span><span class="mspace" id="MathJax-Span-139" style="height: 0em; vertical-align: 0em; width: 0.301em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.718em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">
   \Psi_{\text{vol}}(J) = \kappa \frac{1}{4} [ J^2 - 1
   - 2\textrm{ln}\; J ]</script>, where <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-142" style="width: 7.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1006.19em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-143"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main; padding-left: 0.301em;">:<span style="font-family: MathJax_Main;">=</span></span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic; padding-left: 0.301em;"></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main; padding-left: 0.241em;">+</span><span class="mn" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.241em;">2</span><span class="texatom" id="MathJax-Span-149"><span class="mrow" id="MathJax-Span-150"><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-152" style="font-family: MathJax_Main;">3</span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\kappa:= \lambda + 2/3 \mu</script> is the <a href="http://en.wikipedia.org/wiki/Bulk_modulus">bulk modulus</a> and <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-154" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1000.6em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-155"><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\lambda</script> is <a href="http://en.wikipedia.org/wiki/Lam%C3%A9_parameters">Lame's first parameter</a>.</p>
<p>The following class will be used to characterize the material we work with, and provides a central point that one would need to modify if one were to implement a different material model. For it to work, we will store one object of this type per quadrature point, and in each of these objects store the current state (characterized by the values or measures of the displacement field) so that we can compute the elastic coefficients linearized around the current state.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keyword">class </span>Material_Compressible_Neo_Hook_One_Field</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;   <span class="keyword">public</span>:</div>
<div class="line">&nbsp;     Material_Compressible_Neo_Hook_One_Field(<span class="keyword">const</span> <span class="keywordtype">double</span> mu,</div>
<div class="line">&nbsp;                                              <span class="keyword">const</span> <span class="keywordtype">double</span> nu)</div>
<div class="line">&nbsp;       :</div>
<div class="line">&nbsp;       kappa((2.0 * mu * (1.0 + nu)) / (3.0 * (1.0 - 2.0 * nu))),</div>
<div class="line">&nbsp;       c_1(mu / 2.0)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(kappa &gt; 0, ExcInternalError());</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     ~Material_Compressible_Neo_Hook_One_Field()</div>
<div class="line">&nbsp;     {}</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II_2base_2exceptions_8h_source.html#l01614">exceptions.h:1614</a></div></div>
</div><!-- fragment --><p>The first function is the total energy <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-157" style="width: 8.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1006.91em, 2.562em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-158"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-161" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.777em;"><span class="texatom" id="MathJax-Span-163"><span class="mrow" id="MathJax-Span-164"><span class="texatom" id="MathJax-Span-165"><span class="mrow" id="MathJax-Span-166"><span class="mtext" id="MathJax-Span-167" style="font-size: 70.7%; font-family: MathJax_Main;">iso</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-169" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.777em;"><span class="texatom" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="texatom" id="MathJax-Span-173"><span class="mrow" id="MathJax-Span-174"><span class="mtext" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Main;">vol</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">\Psi = \Psi_{\textrm{iso}} + \Psi_{\textrm{vol}}</script>.</p>
<div class="fragment"><div class="line">&nbsp;     NumberType</div>
<div class="line">&nbsp;     get_Psi(<span class="keyword">const</span> NumberType                        &amp;det_F,</div>
<div class="line">&nbsp;             <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> get_Psi_vol(det_F) + get_Psi_iso(b_bar);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassSymmetricTensor_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h_source.html#l00718">symmetric_tensor.h:719</a></div></div>
</div><!-- fragment --><p>The second function determines the Kirchhoff stress <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-176" style="width: 7.443em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.432em, 1006.19em, 2.562em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-bold-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-180" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-bold-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-182"><span class="mrow" id="MathJax-Span-183"><span class="texatom" id="MathJax-Span-184"><span class="mrow" id="MathJax-Span-185"><span class="mtext" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Main;">iso</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main; padding-left: 0.241em;">+</span><span class="msubsup" id="MathJax-Span-188" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math-bold-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-190"><span class="mrow" id="MathJax-Span-191"><span class="texatom" id="MathJax-Span-192"><span class="mrow" id="MathJax-Span-193"><span class="mtext" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Main;">vol</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">\boldsymbol{\tau}
   = \boldsymbol{\tau}_{\textrm{iso}} + \boldsymbol{\tau}_{\textrm{vol}}</script></p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a></div>
<div class="line">&nbsp;     get_tau(<span class="keyword">const</span> NumberType                        &amp;det_F,</div>
<div class="line">&nbsp;             <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar)</div>
<div class="line">&nbsp;     {</div>
</div><!-- fragment --><p>See Holzapfel p231 eq6.98 onwards</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keywordflow">return</span> get_tau_vol(det_F) + get_tau_iso(b_bar);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>The fourth-order elasticity tensor in the spatial setting <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-195" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.36em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-196"><span class="texatom" id="MathJax-Span-197"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Fraktur;">c</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\mathfrak{c}</script> is calculated from the SEF <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-200" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1000.72em, 2.384em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">\Psi</script> as <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-203" style="width: 15.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.622em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1012.62em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-204"><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-206"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-207"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Fraktur;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-210"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mi" id="MathJax-Span-215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-217" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.658em;"><span class="texatom" id="MathJax-Span-219"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-223"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.658em;"><span class="texatom" id="MathJax-Span-225"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-228" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-229"><span style="display: inline-block; position: relative; width: 2.86em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-230"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Fraktur;">C</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-233"><span class="mrow" id="MathJax-Span-234"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span class="mi" id="MathJax-Span-236" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-238" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-239"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.658em;"><span class="texatom" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="mi" id="MathJax-Span-243" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mi" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-245"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.658em;"><span class="texatom" id="MathJax-Span-247"><span class="mrow" id="MathJax-Span-248"><span class="mi" id="MathJax-Span-249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20"> J
   \mathfrak{c}_{ijkl} = F_{iA} F_{jB} \mathfrak{C}_{ABCD} F_{kC} F_{lD}</script> where <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-251" style="width: 6.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.777em, 1005.3em, 2.801em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-252"><span class="texatom" id="MathJax-Span-253"><span class="mrow" id="MathJax-Span-254"><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Fraktur;">C</span></span></span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-257" style="font-family: MathJax_Main; padding-left: 0.301em;">4</span><span class="mfrac" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 2.562em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em, 1002.38em, 4.348em, -999.997em); top: -4.58em; left: 50%; margin-left: -1.247em;"><span class="mrow" id="MathJax-Span-259"><span class="msubsup" id="MathJax-Span-260"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-261" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.479em;"><span class="mn" id="MathJax-Span-262" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-264" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-265"><span class="mrow" id="MathJax-Span-266"><span class="mi" id="MathJax-Span-267" style="font-size: 70.7%; font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.91em, 4.17em, -999.997em); top: -3.568em; left: 50%; margin-left: -1.009em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%; font-family: MathJax_Main-bold;">C</span></span></span><span class="mi" id="MathJax-Span-274" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-275"><span class="mrow" id="MathJax-Span-276"><span class="mi" id="MathJax-Span-277" style="font-size: 70.7%; font-family: MathJax_Main-bold;">C</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1002.56em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.562em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 2.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21"> \mathfrak{C} = 4 \frac{\partial^2 \Psi(\mathbf{C})}{\partial
   \mathbf{C} \partial \mathbf{C}}</script></p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4,dim,NumberType&gt;</a></div>
<div class="line">&nbsp;     get_Jc(<span class="keyword">const</span> NumberType                        &amp;det_F,</div>
<div class="line">&nbsp;            <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> get_Jc_vol(det_F) + get_Jc_iso(b_bar);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">private</span>:</div>
</div><!-- fragment --><p>Define constitutive model parameters <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-278" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1000.6em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-279"><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\kappa</script> (bulk modulus) and the neo-Hookean model parameter <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-281" style="width: 1.015em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.42em, 1000.84em, 1.372em, -999.997em); top: -1.009em; left: 0em;"><span class="mrow" id="MathJax-Span-282"><span class="msubsup" id="MathJax-Span-283"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mn" id="MathJax-Span-285" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">c_1</script>:</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> kappa;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> c_1;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Value of the volumetric free energy</p>
<div class="fragment"><div class="line">&nbsp;     NumberType</div>
<div class="line">&nbsp;     get_Psi_vol(<span class="keyword">const</span> NumberType &amp;det_F) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> (kappa / 4.0) * (det_F*det_F - 1.0 - 2.0*<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html#a13d94cfcf476eca882b8aa47d6119f29">std::log</a>(det_F));</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="anamespacestd_html_a13d94cfcf476eca882b8aa47d6119f29"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html#a13d94cfcf476eca882b8aa47d6119f29">std::log</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; log(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/vectorization_8h_source.html#l05924">vectorization.h:5924</a></div></div>
</div><!-- fragment --><p>Value of the isochoric free energy</p>
<div class="fragment"><div class="line">&nbsp;     NumberType</div>
<div class="line">&nbsp;     get_Psi_iso(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> c_1 * (<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a82808d9c285700b167c758f42c79e833">trace</a>(b_bar) - dim);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="asymmetric__tensor_8h_html_a82808d9c285700b167c758f42c79e833"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a82808d9c285700b167c758f42c79e833">trace</a></div><div class="ttdeci">DEAL_II_HOST constexpr Number trace(const SymmetricTensor&lt; 2, dim2, Number &gt; &amp;)</div></div>
</div><!-- fragment --><p>Derivative of the volumetric free energy with respect to <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-286" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1000.6em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-287"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">J</script> return <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-289" style="width: 3.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.039em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-0.295em, 1003.04em, 1.61em, -999.997em); top: -1.009em; left: 0em;"><span class="mrow" id="MathJax-Span-290"><span class="mfrac" id="MathJax-Span-291"><span style="display: inline-block; position: relative; width: 2.801em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.277em, 1002.56em, 4.348em, -999.997em); top: -4.58em; left: 50%; margin-left: -1.307em;"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-294"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.539em;"><span class="texatom" id="MathJax-Span-296"><span class="mrow" id="MathJax-Span-297"><span class="mtext" id="MathJax-Span-298" style="font-size: 50%; font-family: MathJax_Main;">vol</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.17em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.414em;"><span class="mrow" id="MathJax-Span-302"><span class="mi" id="MathJax-Span-303" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1002.8em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.801em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 2.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\frac{\partial
   \Psi_{\text{vol}}(J)}{\partial J}</script></p>
<div class="fragment"><div class="line">&nbsp;     NumberType</div>
<div class="line">&nbsp;     get_dPsi_vol_dJ(<span class="keyword">const</span> NumberType &amp;det_F) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> (kappa / 2.0) * (det_F - 1.0 / det_F);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>The following functions are used internally in determining the result of some of the public functions above. The first one determines the volumetric Kirchhoff stress <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-305" style="width: 1.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.42em, 1001.55em, 1.372em, -999.997em); top: -1.009em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="msubsup" id="MathJax-Span-307"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math-bold-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-309"><span class="mrow" id="MathJax-Span-310"><span class="texatom" id="MathJax-Span-311"><span class="mrow" id="MathJax-Span-312"><span class="mtext" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Main;">vol</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">\boldsymbol{\tau}_{\textrm{vol}}</script>. Note the difference in its definition when compared to <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/step_44.html">step-44</a>.</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a></div>
<div class="line">&nbsp;     get_tau_vol(<span class="keyword">const</span> NumberType &amp;det_F) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> NumberType(get_dPsi_vol_dJ(det_F) * det_F) * <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors&lt;dim&gt;::I</a>;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassPhysics_1_1Elasticity_1_1StandardTensors_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/standard__tensors_8h_source.html#l00045">standard_tensors.h:46</a></div></div>
</div><!-- fragment --><p>Next, determine the isochoric Kirchhoff stress  <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-314" style="width: 6.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.122em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1005.12em, 2.562em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-315"><span class="msubsup" id="MathJax-Span-316"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-317" style="font-family: MathJax_Math-bold-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-318"><span class="mrow" id="MathJax-Span-319"><span class="texatom" id="MathJax-Span-320"><span class="mrow" id="MathJax-Span-321"><span class="mtext" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Main;">iso</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="texatom" id="MathJax-Span-324" style="padding-left: 0.301em;"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main; padding-left: 0.301em;">:</span><span class="munderover" id="MathJax-Span-328" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math-bold-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1000.6em, 3.812em, -999.997em); top: -4.223em; left: 0.122em;"><span class="mo" id="MathJax-Span-330" style=""><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; top: -3.985em; left: -0.057em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.301em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.122em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">\boldsymbol{\tau}_{\textrm{iso}} =
   \mathcal{P}:\overline{\boldsymbol{\tau}}</script>:</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a></div>
<div class="line">&nbsp;     get_tau_iso(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors&lt;dim&gt;::dev_P</a> * get_tau_bar(b_bar);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Then, determine the fictitious Kirchhoff stress <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-331" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.063em, 1000.66em, 1.193em, -999.997em); top: -1.009em; left: 0em;"><span class="mrow" id="MathJax-Span-332"><span class="munderover" id="MathJax-Span-333"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math-bold-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1000.6em, 3.812em, -999.997em); top: -4.223em; left: 0.122em;"><span class="mo" id="MathJax-Span-335" style=""><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; top: -3.985em; left: -0.057em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.301em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.985em; left: 0.122em;"><span style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">\overline{\boldsymbol{\tau}}</script>:</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a></div>
<div class="line">&nbsp;     get_tau_bar(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> 2.0 * c_1 * b_bar;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Second derivative of the volumetric free energy wrt <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-336" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1000.6em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-337"><span class="mi" id="MathJax-Span-338" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">J</script>. We need the following computation explicitly in the tangent so we make it public. We calculate <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-339" style="width: 4.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.396em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-0.414em, 1003.4em, 1.61em, -999.997em); top: -1.009em; left: 0em;"><span class="mrow" id="MathJax-Span-340"><span class="mfrac" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 3.158em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em, 1002.98em, 4.348em, -999.997em); top: -4.58em; left: 50%; margin-left: -1.485em;"><span class="mrow" id="MathJax-Span-342"><span class="msubsup" id="MathJax-Span-343"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-344" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.479em;"><span class="mn" id="MathJax-Span-345" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-346"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-347" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.539em;"><span class="texatom" id="MathJax-Span-348"><span class="mrow" id="MathJax-Span-349"><span class="texatom" id="MathJax-Span-350"><span class="mrow" id="MathJax-Span-351"><span class="mtext" id="MathJax-Span-352" style="font-size: 50%; font-family: MathJax_Main;">vol</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-353" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-354" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-355" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.67em, 4.17em, -999.997em); top: -3.568em; left: 50%; margin-left: -0.83em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mi" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1003.16em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.158em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 2.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">\frac{\partial^2
   \Psi_{\textrm{vol}}(J)}{\partial J \partial
   J}</script></p>
<div class="fragment"><div class="line">&nbsp;     NumberType</div>
<div class="line">&nbsp;     get_d2Psi_vol_dJ2(<span class="keyword">const</span> NumberType &amp;det_F) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> ( (kappa / 2.0) * (1.0 + 1.0 / (det_F * det_F)));</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Calculate the volumetric part of the tangent <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-361" style="width: 2.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.97em, 2.324em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-362"><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-364"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-365"><span class="mrow" id="MathJax-Span-366"><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Fraktur;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-368"><span class="mrow" id="MathJax-Span-369"><span class="mtext" id="MathJax-Span-370" style="font-size: 70.7%; font-family: MathJax_Main;">vol</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">J
   \mathfrak{c}_\textrm{vol}</script>. Again, note the difference in its definition when compared to <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/step_44.html">step-44</a>. The extra terms result from two quantities in <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-371" style="width: 1.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.42em, 1001.55em, 1.372em, -999.997em); top: -1.009em; left: 0em;"><span class="mrow" id="MathJax-Span-372"><span class="msubsup" id="MathJax-Span-373"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math-bold-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="texatom" id="MathJax-Span-375"><span class="mrow" id="MathJax-Span-376"><span class="texatom" id="MathJax-Span-377"><span class="mrow" id="MathJax-Span-378"><span class="mtext" id="MathJax-Span-379" style="font-size: 70.7%; font-family: MathJax_Main;">vol</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">\boldsymbol{\tau}_{\textrm{vol}}</script> being dependent on <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-380" style="width: 1.015em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1000.84em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-381"><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Math-bold-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">\boldsymbol{F}</script>.</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4,dim,NumberType&gt;</a></div>
<div class="line">&nbsp;     get_Jc_vol(<span class="keyword">const</span> NumberType &amp;det_F) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
</div><!-- fragment --><p>See Holzapfel p265</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keywordflow">return</span> det_F</div>
<div class="line">&nbsp;              * ( (get_dPsi_vol_dJ(det_F) + det_F * get_d2Psi_vol_dJ2(det_F))*<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors&lt;dim&gt;::IxI</a></div>
<div class="line">&nbsp;                  - (2.0 * get_dPsi_vol_dJ(det_F))*<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors&lt;dim&gt;::S</a> );</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Calculate the isochoric part of the tangent <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-383" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.91em, 2.324em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-384"><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="msubsup" id="MathJax-Span-386"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-387"><span class="mrow" id="MathJax-Span-388"><span class="mi" id="MathJax-Span-389" style="font-family: MathJax_Fraktur;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-390"><span class="mrow" id="MathJax-Span-391"><span class="mtext" id="MathJax-Span-392" style="font-size: 70.7%; font-family: MathJax_Main;">iso</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">J
   \mathfrak{c}_\textrm{iso}</script>:</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4,dim,NumberType&gt;</a></div>
<div class="line">&nbsp;     get_Jc_iso(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2, dim&gt;</a> tau_bar = get_tau_bar(b_bar);</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2, dim&gt;</a> tau_iso = get_tau_iso(b_bar);</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4, dim&gt;</a> tau_iso_x_I</div>
<div class="line">&nbsp;         = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a548c077df22f64aae4000c382c253dce">outer_product</a>(tau_iso,</div>
<div class="line">&nbsp;                         <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors&lt;dim&gt;::I</a>);</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4, dim&gt;</a> I_x_tau_iso</div>
<div class="line">&nbsp;         = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a548c077df22f64aae4000c382c253dce">outer_product</a>(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors&lt;dim&gt;::I</a>,</div>
<div class="line">&nbsp;                         tau_iso);</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4, dim&gt;</a> c_bar = get_c_bar();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> (2.0 / dim) * <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a82808d9c285700b167c758f42c79e833">trace</a>(tau_bar)</div>
<div class="line">&nbsp;              * <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors&lt;dim&gt;::dev_P</a></div>
<div class="line">&nbsp;              - (2.0 / dim) * (tau_iso_x_I + I_x_tau_iso)</div>
<div class="line">&nbsp;              + <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors&lt;dim&gt;::dev_P</a> * c_bar</div>
<div class="line">&nbsp;              * <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPhysics_1_1Elasticity_1_1StandardTensors.html">Physics::Elasticity::StandardTensors&lt;dim&gt;::dev_P</a>;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="asymmetric__tensor_8h_html_a548c077df22f64aae4000c382c253dce"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a548c077df22f64aae4000c382c253dce">outer_product</a></div><div class="ttdeci">DEAL_II_HOST constexpr SymmetricTensor&lt; 4, dim, Number &gt; outer_product(const SymmetricTensor&lt; 2, dim, Number &gt; &amp;t1, const SymmetricTensor&lt; 2, dim, Number &gt; &amp;t2)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h_source.html#l03509">symmetric_tensor.h:3509</a></div></div>
</div><!-- fragment --><p>Calculate the fictitious elasticity tensor <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-393" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.063em, 1000.36em, 1.193em, -999.997em); top: -1.009em; left: 0em;"><span class="mrow" id="MathJax-Span-394"><span class="munderover" id="MathJax-Span-395"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-396"><span class="mrow" id="MathJax-Span-397"><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Fraktur;">c</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.277em, 1000.3em, 3.812em, -999.997em); top: -4.283em; left: 0.003em;"><span class="mo" id="MathJax-Span-399" style=""><span><span style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">\overline{\mathfrak{c}}</script>. For the material model chosen this is simply zero:</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4,dim,double&gt;</a></div>
<div class="line">&nbsp;     get_c_bar() const</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4, dim&gt;</a>();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp;   };</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Quadraturepointhistory"></a> </p><h3><a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classQuadrature.html">Quadrature</a> point history</h3>
<p>As seen in <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/step_18.html">step-18</a>, the <code> PointHistory </code> class offers a method for storing data at the quadrature points. Here each quadrature point holds a pointer to a material description. Thus, different material models can be used in different regions of the domain. Among other data, we choose to store the Kirchhoff stress <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-400" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1000.6em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-401"><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math-bold-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">\boldsymbol{\tau}</script> and the tangent <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-403" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1000.96em, 2.146em, -999.997em); top: -1.961em; left: 0em;"><span class="mrow" id="MathJax-Span-404"><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="texatom" id="MathJax-Span-406"><span class="mrow" id="MathJax-Span-407"><span class="mi" id="MathJax-Span-408" style="font-family: MathJax_Fraktur;">c</span></span></span></span><span style="display: inline-block; width: 0px; height: 1.967em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">J\mathfrak{c}</script> for the quadrature points.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keyword">class </span>PointHistory</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;   <span class="keyword">public</span>:</div>
<div class="line">&nbsp;     PointHistory()</div>
<div class="line">&nbsp;     {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">virtual</span> ~PointHistory()</div>
<div class="line">&nbsp;     {}</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>The first function is used to create a material object and to initialize all tensors correctly: The second one updates the stored values and stresses based on the current deformation measure <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-409" style="width: 4.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.396em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1003.4em, 2.562em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-410"><span class="texatom" id="MathJax-Span-411"><span class="mrow" id="MathJax-Span-412"><span class="mtext" id="MathJax-Span-413" style="font-family: MathJax_Main;">Grad</span></span></span><span class="msubsup" id="MathJax-Span-414"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-415"><span class="mrow" id="MathJax-Span-416"><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Main-bold;">u</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.658em;"><span class="texatom" id="MathJax-Span-418"><span class="mrow" id="MathJax-Span-419"><span class="texatom" id="MathJax-Span-420"><span class="mrow" id="MathJax-Span-421"><span class="mtext" id="MathJax-Span-422" style="font-size: 70.7%; font-family: MathJax_Main;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">\textrm{Grad}\mathbf{u}_{\textrm{n}}</script>.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span> setup_lqp (<span class="keyword">const</span> Parameters::AllParameters &amp;parameters)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       material.reset(<span class="keyword">new</span> Material_Compressible_Neo_Hook_One_Field&lt;dim,NumberType&gt;(parameters.mu,</div>
<div class="line">&nbsp;                      parameters.nu));</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We offer an interface to retrieve certain data. This is the strain energy:</p>
<div class="fragment"><div class="line">&nbsp;     NumberType</div>
<div class="line">&nbsp;     get_Psi(<span class="keyword">const</span> NumberType                        &amp;det_F,</div>
<div class="line">&nbsp;             <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> material-&gt;get_Psi(det_F,b_bar);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Here are the kinetic variables. These are used in the material and global tangent matrix and residual assembly operations: First is the Kirchhoff stress:</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a></div>
<div class="line">&nbsp;     get_tau(<span class="keyword">const</span> NumberType                        &amp;det_F,</div>
<div class="line">&nbsp;             <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> material-&gt;get_tau(det_F,b_bar);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>And the tangent:</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4,dim,NumberType&gt;</a></div>
<div class="line">&nbsp;     get_Jc(<span class="keyword">const</span> NumberType                        &amp;det_F,</div>
<div class="line">&nbsp;            <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> &amp;b_bar) <span class="keyword">const</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> material-&gt;get_Jc(det_F,b_bar);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>In terms of member functions, this class stores for the quadrature point it represents a copy of a material type in case different materials are used in different regions of the domain, as well as the inverse of the deformation gradient...</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">private</span>:</div>
<div class="line">&nbsp;     std::shared_ptr&lt; Material_Compressible_Neo_Hook_One_Field&lt;dim,NumberType&gt; &gt; material;</div>
<div class="line">&nbsp;   };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Quasistaticcompressiblefinitestrainsolid"></a> </p><h3>Quasi-static compressible finite-strain solid</h3>
<p>Forward declarations for classes that will perform assembly of the linear system.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keyword">struct </span>Assembler_Base;</div>
<div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keyword">struct </span>Assembler;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>The Solid class is the central class in that it represents the problem at hand. It follows the usual scheme in that all it really has is a constructor, destructor and a <code>run()</code> function that dispatches all the work to private functions of this class:</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keyword">class </span>Solid</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;   <span class="keyword">public</span>:</div>
<div class="line">&nbsp;     Solid(<span class="keyword">const</span> Parameters::AllParameters &amp;parameters);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">virtual</span></div>
<div class="line">&nbsp;     ~Solid();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     run();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">private</span>:</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We start the collection of member functions with one that builds the grid:</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     make_grid();</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Set up the finite element system to be solved:</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     system_setup();</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Several functions to assemble the system and right hand side matrices using multithreading. Each of them comes as a wrapper function, one that is executed to do the work in the <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/namespaceWorkStream.html">WorkStream</a> model on one cell, and one that copies the work done on this one cell into the global object that represents it:</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     assemble_system(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;solution_delta);</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassBlockVector_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/block__vector_8h_source.html#l00071">block_vector.h:72</a></div></div>
</div><!-- fragment --><p>We use a separate data structure to perform the assembly. It needs access to some low-level data, so we simply befriend the class instead of creating a complex interface to provide access as necessary.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">friend</span> <span class="keyword">struct </span>Assembler_Base&lt;dim,NumberType&gt;;</div>
<div class="line">&nbsp;     <span class="keyword">friend</span> <span class="keyword">struct </span>Assembler&lt;dim,NumberType&gt;;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Apply Dirichlet boundary conditions on the displacement field</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     make_constraints(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;it_nr);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Create and update the quadrature points. Here, no data needs to be copied into a global object, so the copy_local_to_global function is empty:</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     setup_qph();</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Solve for the displacement using a Newton-Raphson method. We break this function into the nonlinear loop and the function that solves the linearized Newton-Raphson step:</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     solve_nonlinear_timestep(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;solution_delta);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     std::pair&lt;unsigned int, double&gt;</div>
<div class="line">&nbsp;     solve_linear_system(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;newton_update);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Solution retrieval as well as post-processing and writing data to file :</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a></div>
<div class="line">&nbsp;     get_total_solution(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;solution_delta) <span class="keyword">const</span>;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     output_results() <span class="keyword">const</span>;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Finally, some member variables that describe the current state: A collection of the parameters used to describe the problem setup...</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">const</span> Parameters::AllParameters &amp;parameters;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>...the volume of the reference and current configurations...</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">double</span>                           vol_reference;</div>
<div class="line">&nbsp;     <span class="keywordtype">double</span>                           vol_current;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>...and description of the geometry on which the problem is solved:</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTriangulation.html">Triangulation&lt;dim&gt;</a>               <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassTriangulation_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classTriangulation.html">Triangulation</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/grid_2tria_8h_source.html#l01136">tria.h:1137</a></div></div>
<div class="ttc" id="ap4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
</div><!-- fragment --><p>Also, keep track of the current time and the time spent evaluating certain functions</p>
<div class="fragment"><div class="line">&nbsp;     Time                             time;</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTimerOutput.html">TimerOutput</a>                      timer;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassTimerOutput_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classTimerOutput.html">TimerOutput</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/timer_8h_source.html#l00549">timer.h:550</a></div></div>
</div><!-- fragment --><p>A storage object for quadrature point information. As opposed to <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/step_18.html">step-18</a>, deal.II's native quadrature point data manager is employed here.</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classCellDataStorage.html">CellDataStorage&lt;typename Triangulation&lt;dim&gt;::cell_iterator</a>,</div>
<div class="line">&nbsp;                     PointHistory&lt;dim,NumberType&gt; &gt; quadrature_point_history;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassCellDataStorage_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classCellDataStorage.html">CellDataStorage</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/quadrature__point__data_8h_source.html#l00064">quadrature_point_data.h:65</a></div></div>
</div><!-- fragment --><p>A description of the finite-element system including the displacement polynomial degree, the degree-of-freedom handler, number of DoFs per cell and the extractor objects used to retrieve information from the solution vectors:</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               degree;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFESystem.html">FESystem&lt;dim&gt;</a>              fe;</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classDoFHandler.html">DoFHandler&lt;dim&gt;</a>                  dof_handler_ref;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               dofs_per_cell;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_struct" href="https://www.dealii.org/current/doxygen/deal.II/structFEValuesExtractors_1_1Vector.html">FEValuesExtractors::Vector</a> u_fe;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassDoFHandler_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/dof__handler_8h_source.html#l00317">dof_handler.h:318</a></div></div>
<div class="ttc" id="astructFEValuesExtractors_1_1Vector_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/structFEValuesExtractors_1_1Vector.html">FEValuesExtractors::Vector</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe__values__extractors_8h_source.html#l00150">fe_values_extractors.h:151</a></div></div>
</div><!-- fragment --><p>Description of how the block-system is arranged. There is just 1 block, that contains a vector DOF <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-423" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.66em, 2.384em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-424"><span class="texatom" id="MathJax-Span-425"><span class="mrow" id="MathJax-Span-426"><span class="mi" id="MathJax-Span-427" style="font-family: MathJax_Main-bold;">u</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">\mathbf{u}</script>. There are two reasons that we retain the block system in this problem. The first is pure laziness to perform further modifications to the code from which this work originated. The second is that a block system would typically necessary when extending this code to multiphysics problems.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>        n_blocks = 1;</div>
<div class="line">&nbsp;     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>        n_components = dim;</div>
<div class="line">&nbsp;     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>        first_u_component = 0;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">enum</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       u_dof = 0</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     std::vector&lt;types::global_dof_index&gt;  dofs_per_block;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Rules for Gauss-quadrature on both the cell and faces. The number of quadrature points on both cells and faces is recorded.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classQGauss.html">QGauss&lt;dim&gt;</a>                qf_cell;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classQGauss.html">QGauss</a>&lt;dim - 1&gt;            qf_face;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               n_q_points;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               n_q_points_f;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassQGauss_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/quadrature__lib_8h_source.html#l00040">quadrature_lib.h:41</a></div></div>
</div><!-- fragment --><p>Objects that store the converged solution and right-hand side vectors, as well as the tangent matrix. There is a <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classAffineConstraints.html">AffineConstraints</a> object used to keep track of constraints. We make use of a sparsity pattern designed for a block system.</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>        constraints;</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockSparsityPattern.html">BlockSparsityPattern</a>             sparsity_pattern;</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockSparseMatrix.html">BlockSparseMatrix&lt;double&gt;</a>        tangent_matrix;</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a>              system_rhs;</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a>              solution_n;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassAffineConstraints_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classAffineConstraints.html">AffineConstraints</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/affine__constraints_8h_source.html#l00514">affine_constraints.h:515</a></div></div>
<div class="ttc" id="aclassBlockSparseMatrix_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classBlockSparseMatrix.html">BlockSparseMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/block__sparse__matrix_8h_source.html#l00050">block_sparse_matrix.h:51</a></div></div>
<div class="ttc" id="aclassBlockSparsityPattern_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classBlockSparsityPattern.html">BlockSparsityPattern</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/block__sparsity__pattern_8h_source.html#l00437">block_sparsity_pattern.h:438</a></div></div>
</div><!-- fragment --><p>Then define a number of variables to store norms and update norms and normalisation factors.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>Errors</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       Errors()</div>
<div class="line">&nbsp;         :</div>
<div class="line">&nbsp;         norm(1.0), u(1.0)</div>
<div class="line">&nbsp;       {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">void</span> reset()</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         norm = 1.0;</div>
<div class="line">&nbsp;         u = 1.0;</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;       <span class="keywordtype">void</span> normalise(<span class="keyword">const</span> Errors &amp;rhs)</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         <span class="keywordflow">if</span> (rhs.norm != 0.0)</div>
<div class="line">&nbsp;           <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceLocalIntegrators_1_1Divergence.html#a1e082fc685ca521120a8250f87fb4924">norm</a> /= rhs.norm;</div>
<div class="line">&nbsp;         <span class="keywordflow">if</span> (rhs.u != 0.0)</div>
<div class="line">&nbsp;           u /= rhs.u;</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordtype">double</span> <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceLocalIntegrators_1_1Divergence.html#a1e082fc685ca521120a8250f87fb4924">norm</a>, u;</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     Errors error_residual, error_residual_0, error_residual_norm, error_update,</div>
<div class="line">&nbsp;            error_update_0, error_update_norm;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1Divergence_html_a1e082fc685ca521120a8250f87fb4924"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceLocalIntegrators_1_1Divergence.html#a1e082fc685ca521120a8250f87fb4924">LocalIntegrators::Divergence::norm</a></div><div class="ttdeci">double norm(const FEValuesBase&lt; dim &gt; &amp;fe, const ArrayView&lt; const std::vector&lt; Tensor&lt; 1, dim &gt; &gt; &gt; &amp;Du)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/divergence_8h_source.html#l00472">divergence.h:472</a></div></div>
</div><!-- fragment --><p>Methods to calculate error measures</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     get_error_residual(Errors &amp;error_residual);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     get_error_update(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;newton_update,</div>
<div class="line">&nbsp;                      Errors &amp;error_update);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Print information to screen in a pleasing way...</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">static</span></div>
<div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     print_conv_header();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     print_conv_footer();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     print_vertical_tip_displacement();</div>
<div class="line">&nbsp;   };</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="ImplementationofthecodeSolidcodeclass"></a> </p><h3>Implementation of the <code>Solid</code> class</h3>
<p><a class="anchor" id="Publicinterface"></a> </p><h4>Public interface</h4>
<p>We initialise the Solid class using data extracted from the parameter file.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   Solid&lt;dim,NumberType&gt;::Solid(<span class="keyword">const</span> Parameters::AllParameters &amp;parameters)</div>
<div class="line">&nbsp;     :</div>
<div class="line">&nbsp;     parameters(parameters),</div>
<div class="line">&nbsp;     vol_reference (0.0),</div>
<div class="line">&nbsp;     vol_current (0.0),</div>
<div class="line">&nbsp;     <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTriangulation.html">Triangulation</a>&lt;dim&gt;::maximum_smoothing),</div>
<div class="line">&nbsp;     time(parameters.end_time, parameters.delta_t),</div>
<div class="line">&nbsp;     timer(<a class="code hl_namespace" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html">std</a>::cout,</div>
<div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTimerOutput.html">TimerOutput</a>::summary,</div>
<div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTimerOutput.html">TimerOutput</a>::wall_times),</div>
<div class="line">&nbsp;     degree(parameters.poly_degree),</div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html">std</a></div><div class="ttdoc">STL namespace.</div></div>
</div><!-- fragment --><p>The Finite Element System is composed of dim continuous displacement DOFs.</p>
<div class="fragment"><div class="line">&nbsp;     fe(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFE__Q.html">FE_Q&lt;dim&gt;</a>(parameters.poly_degree), dim), <span class="comment">// displacement</span></div>
<div class="line">&nbsp;     dof_handler_ref(<a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>),</div>
<div class="line">&nbsp;     dofs_per_cell (fe.dofs_per_cell),</div>
<div class="line">&nbsp;     u_fe(first_u_component),</div>
<div class="line">&nbsp;     dofs_per_block(n_blocks),</div>
<div class="line">&nbsp;     qf_cell(parameters.quad_order),</div>
<div class="line">&nbsp;     qf_face(parameters.quad_order),</div>
<div class="line">&nbsp;     n_q_points (qf_cell.size()),</div>
<div class="line">&nbsp;     n_q_points_f (qf_face.size())</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassFE__Q_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classFE__Q.html">FE_Q</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe__q_8h_source.html#l00550">fe_q.h:551</a></div></div>
</div><!-- fragment --><p>The class destructor simply clears the data held by the DOFHandler</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   Solid&lt;dim,NumberType&gt;::~Solid()</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     dof_handler_ref.clear();</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>In solving the quasi-static problem, the time becomes a loading parameter, i.e. we increasing the loading linearly with time, making the two concepts interchangeable. We choose to increment time linearly using a constant time step size.</p>
<p>We start the function with preprocessing, and then output the initial grid before starting the simulation proper with the first time (and loading) increment.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::run()</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     make_grid();</div>
<div class="line">&nbsp;     system_setup();</div>
<div class="line">&nbsp;     output_results();</div>
<div class="line">&nbsp;     time.increment();</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We then declare the incremental solution update <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-428" style="width: 6.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.717em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1005.66em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-429"><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math-italic;"></span><span class="texatom" id="MathJax-Span-431"><span class="mrow" id="MathJax-Span-432"><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Main-bold;"></span></span></span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main; padding-left: 0.301em;">:<span style="font-family: MathJax_Main;">=</span></span><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main; padding-left: 0.301em;">{</span><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math-italic;"></span><span class="texatom" id="MathJax-Span-437"><span class="mrow" id="MathJax-Span-438"><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Main-bold;">u</span></span></span><span class="mo" id="MathJax-Span-440" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">\varDelta
   \mathbf{\Xi}:= \{\varDelta \mathbf{u}\}</script> and start the loop over the time domain.</p>
<p>At the beginning, we reset the solution update for this time step...</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> solution_delta(dofs_per_block);</div>
<div class="line">&nbsp;     <span class="keywordflow">while</span> (time.current() &lt;= time.end())</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         solution_delta = 0.0;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>...solve the current time step and update total solution vector  <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-441" style="width: 8.813em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.324em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1007.26em, 2.562em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-442"><span class="msubsup" id="MathJax-Span-443"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-444"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Main-bold;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.777em;"><span class="texatom" id="MathJax-Span-447"><span class="mrow" id="MathJax-Span-448"><span class="texatom" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="mtext" id="MathJax-Span-451" style="font-size: 70.7%; font-family: MathJax_Main;">n</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-452" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-453" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-454"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Main-bold;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.777em;"><span class="texatom" id="MathJax-Span-457"><span class="mrow" id="MathJax-Span-458"><span class="texatom" id="MathJax-Span-459"><span class="mrow" id="MathJax-Span-460"><span class="mtext" id="MathJax-Span-461" style="font-size: 70.7%; font-family: MathJax_Main;">n-1</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-462" style="font-family: MathJax_Main; padding-left: 0.241em;">+</span><span class="mi" id="MathJax-Span-463" style="font-family: MathJax_Math-italic; padding-left: 0.241em;"></span><span class="texatom" id="MathJax-Span-464"><span class="mrow" id="MathJax-Span-465"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Main-bold;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">\mathbf{\Xi}_{\textrm{n}} = \mathbf{\Xi}_{\textrm{n-1}} +
   \varDelta \mathbf{\Xi}</script>...</p>
<div class="fragment"><div class="line">&nbsp;         solve_nonlinear_timestep(solution_delta);</div>
<div class="line">&nbsp;         solution_n += solution_delta;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>...and plot the results before moving on happily to the next time step:</p>
<div class="fragment"><div class="line">&nbsp;         output_results();</div>
<div class="line">&nbsp;         time.increment();</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Lastly, we print the vertical tip displacement of the Cook cantilever after the full load is applied</p>
<div class="fragment"><div class="line">&nbsp;     print_vertical_tip_displacement();</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Privateinterface"></a> </p><h3>Private interface</h3>
<p><a class="anchor" id="Solidmake_grid"></a> </p><h4>Solid::make_grid</h4>
<p>On to the first of the private member functions. Here we create the triangulation of the domain, for which we choose a scaled an anisotripically discretised rectangle which is subsequently transformed into the correct of the Cook cantilever. Each relevant boundary face is then given a boundary ID number.</p>
<p>We then determine the volume of the reference configuration and print it for comparison.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">&nbsp;   <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a> grid_y_transform (<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a> &amp;pt_in)</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;x = pt_in[0];</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;y = pt_in[1];</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> y_upper = 44.0 + (16.0/48.0)*x; <span class="comment">// Line defining upper edge of beam</span></div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> y_lower =  0.0 + (44.0/48.0)*x; <span class="comment">// Line defining lower edge of beam</span></div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> theta = y/44.0; <span class="comment">// Fraction of height along left side of beam</span></div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> y_transform = (1-theta)*y_lower + theta*y_upper; <span class="comment">// Final transformation</span></div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a> pt_out = pt_in;</div>
<div class="line">&nbsp;     pt_out[1] = y_transform;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordflow">return</span> pt_out;</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::make_grid()</div>
<div class="line">&nbsp;   {</div>
<div class="ttc" id="aclassPoint_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/base_2point_8h_source.html#l00111">point.h:112</a></div></div>
</div><!-- fragment --><p>Divide the beam, but only along the x- and y-coordinate directions</p>
<div class="fragment"><div class="line">&nbsp;     std::vector&lt; unsigned int &gt; repetitions(dim, parameters.elements_per_edge);</div>
</div><!-- fragment --><p>Only allow one element through the thickness (modelling a plane strain condition)</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordflow">if</span> (dim == 3)</div>
<div class="line">&nbsp;       repetitions[dim-1] = 1;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a> bottom_left = (dim == 3 ? <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a>(0.0, 0.0, -0.5) : <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point</a>&lt;dim&gt;(0.0, 0.0));</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a> top_right = (dim == 3 ? <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a>(48.0, 44.0, 0.5) : <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point</a>&lt;dim&gt;(48.0, 44.0));</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridGenerator.html#ac76417d7404b75cf53c732f456e6e971">GridGenerator::subdivided_hyper_rectangle</a>(<a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>,</div>
<div class="line">&nbsp;                                               repetitions,</div>
<div class="line">&nbsp;                                               bottom_left,</div>
<div class="line">&nbsp;                                               top_right);</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="anamespaceGridGenerator_html_ac76417d7404b75cf53c732f456e6e971"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridGenerator.html#ac76417d7404b75cf53c732f456e6e971">GridGenerator::subdivided_hyper_rectangle</a></div><div class="ttdeci">void subdivided_hyper_rectangle(Triangulation&lt; dim, spacedim &gt; &amp;tria, const std::vector&lt; unsigned int &gt; &amp;repetitions, const Point&lt; dim &gt; &amp;p1, const Point&lt; dim &gt; &amp;p2, const bool colorize=false)</div></div>
</div><!-- fragment --><p>Since we wish to apply a Neumann BC to the right-hand surface, we must find the cell faces in this part of the domain and mark them with a distinct boundary ID number. The faces we are looking for are on the +x surface and will get boundary ID 11. Dirichlet boundaries exist on the left-hand face of the beam (this fixed boundary will get ID 1) and on the +Z and -Z faces (which correspond to ID 2 and we will use to impose the plane strain condition)</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">double</span> tol_boundary = 1e-6;</div>
<div class="line">&nbsp;     <span class="keyword">typename</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTriaActiveIterator.html">Triangulation&lt;dim&gt;::active_cell_iterator</a> cell =</div>
<div class="line">&nbsp;       <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.begin_active(), endc = <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.end();</div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (; cell != endc; ++cell)</div>
<div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = 0;</div>
<div class="line">&nbsp;            face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++face)</div>
<div class="line">&nbsp;         <span class="keywordflow">if</span> (cell-&gt;face(face)-&gt;at_boundary() == <span class="keyword">true</span>)</div>
<div class="line">&nbsp;           {</div>
<div class="line">&nbsp;             <span class="keywordflow">if</span> (<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html#ae348f4ef7dd5887ba9c50b03a842950a">std::abs</a>(cell-&gt;face(face)-&gt;center()[0] - 0.0) &lt; tol_boundary)</div>
<div class="line">&nbsp;               cell-&gt;face(face)-&gt;set_boundary_id(1); <span class="comment">// -X faces</span></div>
<div class="line">&nbsp;             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html#ae348f4ef7dd5887ba9c50b03a842950a">std::abs</a>(cell-&gt;face(face)-&gt;center()[0] - 48.0) &lt; tol_boundary)</div>
<div class="line">&nbsp;               cell-&gt;face(face)-&gt;set_boundary_id(11); <span class="comment">// +X faces</span></div>
<div class="line">&nbsp;             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3 &amp;&amp; <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html#ae348f4ef7dd5887ba9c50b03a842950a">std::abs</a>(<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html#ae348f4ef7dd5887ba9c50b03a842950a">std::abs</a>(cell-&gt;face(face)-&gt;center()[2]) - 0.5) &lt; tol_boundary)</div>
<div class="line">&nbsp;               cell-&gt;face(face)-&gt;set_boundary_id(2); <span class="comment">// +Z and -Z faces</span></div>
<div class="line">&nbsp;           }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassTriaActiveIterator_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classTriaActiveIterator.html">TriaActiveIterator</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/tria__iterator_8h_source.html#l00759">tria_iterator.h:760</a></div></div>
<div class="ttc" id="anamespacestd_html_ae348f4ef7dd5887ba9c50b03a842950a"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html#ae348f4ef7dd5887ba9c50b03a842950a">std::abs</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; abs(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/vectorization_8h_source.html#l06008">vectorization.h:6008</a></div></div>
</div><!-- fragment --><p>Transform the hyper-rectangle into the beam shape</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridTools.html#a212e99cf0d923cebfa04f1d23fa60b04">GridTools::transform</a>(&amp;grid_y_transform&lt;dim&gt;, <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridTools.html#a0967563badadd81f77f62622dd8bc2cd">GridTools::scale</a>(parameters.scale, <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     vol_reference = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridTools.html#abde377a9a6f142b42aecf41cd56043ae">GridTools::volume</a>(<a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>);</div>
<div class="line">&nbsp;     vol_current = vol_reference;</div>
<div class="line">&nbsp;     std::cout &lt;&lt; <span class="stringliteral">"Grid:\n\t Reference volume: "</span> &lt;&lt; vol_reference &lt;&lt; std::endl;</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="ttc" id="anamespaceGridTools_html_a212e99cf0d923cebfa04f1d23fa60b04"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridTools.html#a212e99cf0d923cebfa04f1d23fa60b04">GridTools::transform</a></div><div class="ttdeci">void transform(const Transformation &amp;transformation, Triangulation&lt; dim, spacedim &gt; &amp;triangulation)</div></div>
<div class="ttc" id="anamespaceGridTools_html_abde377a9a6f142b42aecf41cd56043ae"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridTools.html#abde377a9a6f142b42aecf41cd56043ae">GridTools::volume</a></div><div class="ttdeci">double volume(const Triangulation&lt; dim, spacedim &gt; &amp;tria)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/grid__tools_8cc_source.html#l00144">grid_tools.cc:144</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Solidsystem_setup"></a> </p><h4>Solid::system_setup</h4>
<p>Next we describe how the FE system is setup. We first determine the number of components per block. Since the displacement is a vector component, the first dim components belong to it.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::system_setup()</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     timer.enter_subsection(<span class="stringliteral">"Setup system"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     std::vector&lt;unsigned int&gt; block_component(n_components, u_dof); <span class="comment">// Displacement</span></div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>The DOF handler is then initialised and we renumber the grid in an efficient manner. We also record the number of DOFs per block.</p>
<div class="fragment"><div class="line">&nbsp;     dof_handler_ref.distribute_dofs(fe);</div>
<div class="line">&nbsp;     <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceDoFRenumbering.html#a68651164485490b86d901d9ae1fbfc3b">DoFRenumbering::Cuthill_McKee</a>(dof_handler_ref);</div>
<div class="line">&nbsp;     <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceDoFRenumbering.html#a52c1941406d1ce2937e29a46edf111f4">DoFRenumbering::component_wise</a>(dof_handler_ref, block_component);</div>
<div class="line">&nbsp;     dofs_per_block = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceDoFTools.html#a796721b56b3a90e4e3973c7caae4c3d8">DoFTools::count_dofs_per_fe_block</a>(dof_handler_ref, block_component);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     std::cout &lt;&lt; <span class="stringliteral">"Triangulation:"</span></div>
<div class="line">&nbsp;               &lt;&lt; <span class="stringliteral">"\n\t Number of active cells: "</span> &lt;&lt; <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()</div>
<div class="line">&nbsp;               &lt;&lt; <span class="stringliteral">"\n\t Number of degrees of freedom: "</span> &lt;&lt; dof_handler_ref.n_dofs()</div>
<div class="line">&nbsp;               &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="anamespaceDoFRenumbering_html_a52c1941406d1ce2937e29a46edf111f4"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceDoFRenumbering.html#a52c1941406d1ce2937e29a46edf111f4">DoFRenumbering::component_wise</a></div><div class="ttdeci">void component_wise(DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const std::vector&lt; unsigned int &gt; &amp;target_component=std::vector&lt; unsigned int &gt;())</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/dof__renumbering_8cc_source.html#l00682">dof_renumbering.cc:682</a></div></div>
<div class="ttc" id="anamespaceDoFRenumbering_html_a68651164485490b86d901d9ae1fbfc3b"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceDoFRenumbering.html#a68651164485490b86d901d9ae1fbfc3b">DoFRenumbering::Cuthill_McKee</a></div><div class="ttdeci">void Cuthill_McKee(DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const bool reversed_numbering=false, const bool use_constraints=false, const std::vector&lt; types::global_dof_index &gt; &amp;starting_indices=std::vector&lt; types::global_dof_index &gt;())</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/dof__renumbering_8cc_source.html#l00367">dof_renumbering.cc:367</a></div></div>
<div class="ttc" id="anamespaceDoFTools_html_a796721b56b3a90e4e3973c7caae4c3d8"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceDoFTools.html#a796721b56b3a90e4e3973c7caae4c3d8">DoFTools::count_dofs_per_fe_block</a></div><div class="ttdeci">std::vector&lt; types::global_dof_index &gt; count_dofs_per_fe_block(const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const std::vector&lt; unsigned int &gt; &amp;target_block=std::vector&lt; unsigned int &gt;())</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/dof__tools_8cc_source.html#l01973">dof_tools.cc:1973</a></div></div>
</div><!-- fragment --><p>Setup the sparsity pattern and tangent matrix</p>
<div class="fragment"><div class="line">&nbsp;     tangent_matrix.clear();</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classunsigned_01int.html">types::global_dof_index</a> n_dofs_u = dofs_per_block[u_dof];</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockDynamicSparsityPattern.html">BlockDynamicSparsityPattern</a> csp(n_blocks, n_blocks);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       csp.block(u_dof, u_dof).reinit(n_dofs_u, n_dofs_u);</div>
<div class="line">&nbsp;       csp.collect_sizes();</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassBlockDynamicSparsityPattern_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classBlockDynamicSparsityPattern.html">BlockDynamicSparsityPattern</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/block__sparsity__pattern_8h_source.html#l00548">block_sparsity_pattern.h:550</a></div></div>
<div class="ttc" id="aclassunsigned_01int_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classunsigned_01int.html">unsigned int</a></div></div>
</div><!-- fragment --><p>Naturally, for a one-field vector-valued problem, all of the components of the system are coupled.</p>
<div class="fragment"><div class="line">&nbsp;       <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTable.html">Table&lt;2, DoFTools::Coupling&gt;</a> coupling(n_components, n_components);</div>
<div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0; ii &lt; n_components; ++ii)</div>
<div class="line">&nbsp;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jj = 0; jj &lt; n_components; ++jj)</div>
<div class="line">&nbsp;           coupling[ii][jj] = <a class="code hl_enumvalue" href="https://www.dealii.org/current/doxygen/deal.II/namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a>;</div>
<div class="line">&nbsp;       <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/group__constraints.html#gaf10030e7a598def1a1fa43fb0c005a93">DoFTools::make_sparsity_pattern</a>(dof_handler_ref,</div>
<div class="line">&nbsp;                                       coupling,</div>
<div class="line">&nbsp;                                       csp,</div>
<div class="line">&nbsp;                                       constraints,</div>
<div class="line">&nbsp;                                       <span class="keyword">false</span>);</div>
<div class="line">&nbsp;       sparsity_pattern.copy_from(csp);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     tangent_matrix.reinit(sparsity_pattern);</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassTable_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classTable.html">Table</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/array__view_8h_source.html#l00037">array_view.h:37</a></div></div>
<div class="ttc" id="agroup__constraints_html_gaf10030e7a598def1a1fa43fb0c005a93"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/group__constraints.html#gaf10030e7a598def1a1fa43fb0c005a93">DoFTools::make_sparsity_pattern</a></div><div class="ttdeci">void make_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternBase &amp;sparsity_pattern, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const bool keep_constrained_dofs=true, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/dof__tools__sparsity_8cc_source.html#l00056">dof_tools_sparsity.cc:56</a></div></div>
<div class="ttc" id="anamespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a></div><div class="ttdeci">@ always</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/dof__tools_8h_source.html#l00234">dof_tools.h:234</a></div></div>
</div><!-- fragment --><p>We then set up storage vectors</p>
<div class="fragment"><div class="line">&nbsp;     system_rhs.reinit(dofs_per_block);</div>
<div class="line">&nbsp;     system_rhs.collect_sizes();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     solution_n.reinit(dofs_per_block);</div>
<div class="line">&nbsp;     solution_n.collect_sizes();</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>...and finally set up the quadrature point history:</p>
<div class="fragment"><div class="line">&nbsp;     setup_qph();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     timer.leave_subsection();</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Solidsetup_qph"></a> </p><h4>Solid::setup_qph</h4>
<p>The method used to store quadrature information is already described in <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/step_18.html">step-18</a> and <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/step_44.html">step-44</a>. Here we implement a similar setup for a SMP machine.</p>
<p>Firstly the actual QPH data objects are created. This must be done only once the grid is refined to its finest level.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::setup_qph()</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     std::cout &lt;&lt; <span class="stringliteral">"    Setting up quadrature point data..."</span> &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     quadrature_point_history.initialize(<a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.begin_active(),</div>
<div class="line">&nbsp;                                         <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.end(),</div>
<div class="line">&nbsp;                                         n_q_points);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Next we setup the initial quadrature point data. Note that when the quadrature point data is retrieved, it is returned as a vector of smart pointers.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordflow">for</span> (<span class="keyword">typename</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTriaActiveIterator.html">Triangulation&lt;dim&gt;::active_cell_iterator</a> cell =</div>
<div class="line">&nbsp;            <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.begin_active(); cell != <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.end(); ++cell)</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         <span class="keyword">const</span> std::vector&lt;std::shared_ptr&lt;PointHistory&lt;dim,NumberType&gt; &gt; &gt; lqph =</div>
<div class="line">&nbsp;           quadrature_point_history.get_data(cell);</div>
<div class="line">&nbsp;         <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(lqph.size() == n_q_points, ExcInternalError());</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; n_q_points; ++q_point)</div>
<div class="line">&nbsp;           lqph[q_point]-&gt;setup_lqp(parameters);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Solidsolve_nonlinear_timestep"></a> </p><h4>Solid::solve_nonlinear_timestep</h4>
<p>The next function is the driver method for the Newton-Raphson scheme. At its top we create a new vector to store the current Newton update step, reset the error storage objects and print solver header.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span></div>
<div class="line">&nbsp;   Solid&lt;dim,NumberType&gt;::solve_nonlinear_timestep(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;solution_delta)</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">"Timestep "</span> &lt;&lt; time.get_timestep() &lt;&lt; <span class="stringliteral">" @ "</span></div>
<div class="line">&nbsp;               &lt;&lt; time.current() &lt;&lt; <span class="stringliteral">"s"</span> &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> newton_update(dofs_per_block);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     error_residual.reset();</div>
<div class="line">&nbsp;     error_residual_0.reset();</div>
<div class="line">&nbsp;     error_residual_norm.reset();</div>
<div class="line">&nbsp;     error_update.reset();</div>
<div class="line">&nbsp;     error_update_0.reset();</div>
<div class="line">&nbsp;     error_update_norm.reset();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     print_conv_header();</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We now perform a number of Newton iterations to iteratively solve the nonlinear problem. Since the problem is fully nonlinear and we are using a full Newton method, the data stored in the tangent matrix and right-hand side vector is not reusable and must be cleared at each Newton step. We then initially build the right-hand side vector to check for convergence (and store this value in the first iteration). The unconstrained DOFs of the rhs vector hold the out-of-balance forces. The building is done before assembling the system matrix as the latter is an expensive operation and we can potentially avoid an extra assembly process by not assembling the tangent matrix when convergence is attained.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newton_iteration = 0;</div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (; newton_iteration &lt; parameters.max_iterations_NR;</div>
<div class="line">&nbsp;          ++newton_iteration)</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         std::cout &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; std::setw(2) &lt;&lt; newton_iteration &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; std::flush;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>If we have decided that we want to continue with the iteration, we assemble the tangent, make and impose the Dirichlet constraints, and do the solve of the linearized system:</p>
<div class="fragment"><div class="line">&nbsp;         make_constraints(newton_iteration);</div>
<div class="line">&nbsp;         assemble_system(solution_delta);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         get_error_residual(error_residual);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         <span class="keywordflow">if</span> (newton_iteration == 0)</div>
<div class="line">&nbsp;           error_residual_0 = error_residual;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We can now determine the normalised residual error and check for solution convergence:</p>
<div class="fragment"><div class="line">&nbsp;         error_residual_norm = error_residual;</div>
<div class="line">&nbsp;         error_residual_norm.normalise(error_residual_0);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         <span class="keywordflow">if</span> (newton_iteration &gt; 0 &amp;&amp; error_update_norm.u &lt;= parameters.tol_u</div>
<div class="line">&nbsp;             &amp;&amp; error_residual_norm.u &lt;= parameters.tol_f)</div>
<div class="line">&nbsp;           {</div>
<div class="line">&nbsp;             std::cout &lt;&lt; <span class="stringliteral">" CONVERGED! "</span> &lt;&lt; std::endl;</div>
<div class="line">&nbsp;             print_conv_footer();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;             <span class="keywordflow">break</span>;</div>
<div class="line">&nbsp;           }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         <span class="keyword">const</span> std::pair&lt;unsigned int, double&gt;</div>
<div class="line">&nbsp;         lin_solver_output = solve_linear_system(newton_update);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         get_error_update(newton_update, error_update);</div>
<div class="line">&nbsp;         <span class="keywordflow">if</span> (newton_iteration == 0)</div>
<div class="line">&nbsp;           error_update_0 = error_update;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We can now determine the normalised Newton update error, and perform the actual update of the solution increment for the current time step, update all quadrature point information pertaining to this new displacement and stress state and continue iterating:</p>
<div class="fragment"><div class="line">&nbsp;         error_update_norm = error_update;</div>
<div class="line">&nbsp;         error_update_norm.normalise(error_update_0);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         solution_delta += newton_update;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;         std::cout &lt;&lt; <span class="stringliteral">" | "</span> &lt;&lt; std::fixed &lt;&lt; std::setprecision(3) &lt;&lt; std::setw(7)</div>
<div class="line">&nbsp;                   &lt;&lt; <a class="code hl_namespace" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html">std</a>::scientific &lt;&lt; lin_solver_output.<a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> &lt;&lt; "  "</div>
<div class="line">&nbsp;                   &lt;&lt; lin_solver_output.<a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> &lt;&lt; "  " &lt;&lt; error_residual_norm.norm</div>
<div class="line">&nbsp;                   &lt;&lt; "  " &lt;&lt; error_residual_norm.u &lt;&lt; "  "</div>
<div class="line">&nbsp;                   &lt;&lt; "  " &lt;&lt; error_update_norm.norm &lt;&lt; "  " &lt;&lt; error_update_norm.u</div>
<div class="line">&nbsp;                   &lt;&lt; "  " &lt;&lt; <a class="code hl_namespace" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html">std</a>::endl;</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="agrid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/grid__out_8cc_source.html#l04616">grid_out.cc:4616</a></div></div>
<div class="ttc" id="agrid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/grid__out_8cc_source.html#l04615">grid_out.cc:4615</a></div></div>
</div><!-- fragment --><p>At the end, if it turns out that we have in fact done more iterations than the parameter file allowed, we raise an exception that can be caught in the main() function. The call <code><a class="el" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow(condition,
   exc_object)</a></code> is in essence equivalent to <code>if (!cond) throw exc_object;</code> but the former form fills certain fields in the exception object that identify the location (filename and line number) where the exception was raised to make it simpler to identify where the problem happened.</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a> (newton_iteration &lt;= parameters.max_iterations_NR,</div>
<div class="line">&nbsp;                  ExcMessage(<span class="stringliteral">"No convergence in nonlinear solver!"</span>));</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="ttc" id="agroup__Exceptions_html_gafc0ca7ad85b3ebd64e8e51689ac85caf"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a></div><div class="ttdeci">#define AssertThrow(cond, exc)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II_2base_2exceptions_8h_source.html#l01703">exceptions.h:1703</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Solidprint_conv_headerSolidprint_conv_footerandSolidprint_vertical_tip_displacement"></a> </p><h4>Solid::print_conv_header, Solid::print_conv_footer and Solid::print_vertical_tip_displacement</h4>
<p>This program prints out data in a nice table that is updated on a per-iteration basis. The next two functions set up the table header and footer:</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::print_conv_header()</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l_width = 87;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; l_width; ++i)</div>
<div class="line">&nbsp;       std::cout &lt;&lt; <span class="stringliteral">"_"</span>;</div>
<div class="line">&nbsp;     std::cout &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     std::cout &lt;&lt; <span class="stringliteral">"    SOLVER STEP    "</span></div>
<div class="line">&nbsp;               &lt;&lt; <span class="stringliteral">" |  LIN_IT   LIN_RES    RES_NORM    "</span></div>
<div class="line">&nbsp;               &lt;&lt; <span class="stringliteral">" RES_U     NU_NORM     "</span></div>
<div class="line">&nbsp;               &lt;&lt; <span class="stringliteral">" NU_U "</span> &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; l_width; ++i)</div>
<div class="line">&nbsp;       std::cout &lt;&lt; <span class="stringliteral">"_"</span>;</div>
<div class="line">&nbsp;     std::cout &lt;&lt; std::endl;</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::print_conv_footer()</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l_width = 87;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; l_width; ++i)</div>
<div class="line">&nbsp;       std::cout &lt;&lt; <span class="stringliteral">"_"</span>;</div>
<div class="line">&nbsp;     std::cout &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     std::cout &lt;&lt; <span class="stringliteral">"Relative errors:"</span> &lt;&lt; std::endl</div>
<div class="line">&nbsp;               &lt;&lt; <span class="stringliteral">"Displacement:\t"</span> &lt;&lt; error_update.u / error_update_0.u &lt;&lt; std::endl</div>
<div class="line">&nbsp;               &lt;&lt; <span class="stringliteral">"Force: \t\t"</span> &lt;&lt; error_residual.u / error_residual_0.u &lt;&lt; std::endl</div>
<div class="line">&nbsp;               &lt;&lt; <span class="stringliteral">"v / V_0:\t"</span> &lt;&lt; vol_current &lt;&lt; <span class="stringliteral">" / "</span> &lt;&lt; vol_reference</div>
<div class="line">&nbsp;               &lt;&lt; std::endl;</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>At the end we also output the result that can be compared to that found in the literature, namely the displacement at the upper right corner of the beam.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::print_vertical_tip_displacement()</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l_width = 87;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; l_width; ++i)</div>
<div class="line">&nbsp;       std::cout &lt;&lt; <span class="stringliteral">"_"</span>;</div>
<div class="line">&nbsp;     std::cout &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>The measurement point, as stated in the reference paper, is at the midway point of the surface on which the traction is applied.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a> soln_pt = (dim == 3 ? </div>
<div class="line">&nbsp;                                 <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a>(48.0*parameters.scale, 52.0*parameters.scale, 0.5*parameters.scale) : </div>
<div class="line">&nbsp;                                 <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point</a>&lt;dim&gt;(48.0*parameters.scale, 52.0*parameters.scale));</div>
<div class="line">&nbsp;     <span class="keywordtype">double</span> vertical_tip_displacement = 0.0;</div>
<div class="line">&nbsp;     <span class="keywordtype">double</span> vertical_tip_displacement_check = 0.0;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">typename</span> <a class="code hl_typedef" href="https://www.dealii.org/current/doxygen/deal.II/group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;dim&gt;::active_cell_iterator</a> cell =</div>
<div class="line">&nbsp;       dof_handler_ref.begin_active(), endc = dof_handler_ref.end();</div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (; cell != endc; ++cell)</div>
<div class="line">&nbsp;       {</div>
<div class="ttc" id="agroup__Iterators_html_ga6b8bbcafed8847f3030ea30c6990eb2d"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler::active_cell_iterator</a></div><div class="ttdeci">typename ActiveSelector::active_cell_iterator active_cell_iterator</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/dof__handler_8h_source.html#l00441">dof_handler.h:441</a></div></div>
</div><!-- fragment --><p>if (cell-&gt;point_inside(soln_pt) == true)</p>
<div class="fragment"><div class="line">&nbsp;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;GeometryInfo&lt;dim&gt;::vertices_per_cell; ++v)</div>
<div class="line">&nbsp;           <span class="keywordflow">if</span> (cell-&gt;vertex(v).distance(soln_pt) &lt; 1e-6)</div>
<div class="line">&nbsp;             {</div>
</div><!-- fragment --><p>Extract y-component of solution at the given point This point is coindicent with a vertex, so we can extract it directly as we're using <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classFE__Q.html">FE_Q</a> finite elements that have support at the vertices</p>
<div class="fragment"><div class="line">&nbsp;               vertical_tip_displacement = solution_n(cell-&gt;vertex_dof_index(v,u_dof+1));</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Sanity check using alternate method to extract the solution at the given point. To do this, we must create an <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classFEValues.html">FEValues</a> instance to help us extract the solution value at the desired point</p>
<div class="fragment"><div class="line">&nbsp;               <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classMappingQ.html">MappingQ&lt;dim&gt;</a> mapping (parameters.poly_degree);</div>
<div class="line">&nbsp;               <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPoint.html">Point&lt;dim&gt;</a> qp_unit = mapping.transform_real_to_unit_cell(cell,soln_pt);</div>
<div class="line">&nbsp;               <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classQuadrature.html">Quadrature&lt;dim&gt;</a> soln_qrule (qp_unit);</div>
<div class="line">&nbsp;               <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(soln_qrule.size() == 1, ExcInternalError());</div>
<div class="line">&nbsp;               <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFEValues.html">FEValues&lt;dim&gt;</a> fe_values_soln (fe, soln_qrule, <a class="code hl_enumvalue" href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">&nbsp;               fe_values_soln.reinit(cell);</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassFEValues_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classFEValues.html">FEValues</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe_2fe__values_8h_source.html#l04060">fe_values.h:4061</a></div></div>
<div class="ttc" id="aclassMappingQ_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classMappingQ.html">MappingQ</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/mapping__q_8h_source.html#l00111">mapping_q.h:112</a></div></div>
<div class="ttc" id="aclassQuadrature_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classQuadrature.html">Quadrature</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II_2base_2quadrature_8h_source.html#l00122">quadrature.h:123</a></div></div>
<div class="ttc" id="agroup__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdeci">@ update_values</div><div class="ttdoc">Shape function values.</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe__update__flags_8h_source.html#l00076">fe_update_flags.h:76</a></div></div>
</div><!-- fragment --><p>Extract y-component of solution at given point</p>
<div class="fragment"><div class="line">&nbsp;               std::vector&lt; Tensor&lt;1,dim&gt; &gt; soln_values (soln_qrule.size());</div>
<div class="line">&nbsp;               fe_values_soln[u_fe].get_function_values(solution_n,</div>
<div class="line">&nbsp;                                                        soln_values);</div>
<div class="line">&nbsp;               vertical_tip_displacement_check = soln_values[0][u_dof+1];</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;               <span class="keywordflow">break</span>;</div>
<div class="line">&nbsp;             }</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;     <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(vertical_tip_displacement &gt; 0.0, ExcMessage(<span class="stringliteral">"Found no cell with point inside!"</span>))</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <a class="code hl_namespace" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html">std</a>::cout &lt;&lt; "Vertical tip displacement: " &lt;&lt; vertical_tip_displacement</div>
<div class="line">&nbsp;               &lt;&lt; "\t Check: " &lt;&lt; vertical_tip_displacement_check</div>
<div class="line">&nbsp;               &lt;&lt; <a class="code hl_namespace" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html">std</a>::endl;</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Solidget_error_residual"></a> </p><h4>Solid::get_error_residual</h4>
<p>Determine the true residual error for the problem. That is, determine the error in the residual for the unconstrained degrees of freedom. Note that to do so, we need to ignore constrained DOFs by setting the residual in these vector components to zero.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::get_error_residual(Errors &amp;error_residual)</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> error_res(dofs_per_block);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dof_handler_ref.n_dofs(); ++i)</div>
<div class="line">&nbsp;       <span class="keywordflow">if</span> (!constraints.is_constrained(i))</div>
<div class="line">&nbsp;         error_res(i) = system_rhs(i);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     error_residual.norm = error_res.l2_norm();</div>
<div class="line">&nbsp;     error_residual.u = error_res.block(u_dof).l2_norm();</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Solidget_error_udpate"></a> </p><h4>Solid::get_error_udpate</h4>
<p>Determine the true Newton update error for the problem</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::get_error_update(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;newton_update,</div>
<div class="line">&nbsp;                                                Errors &amp;error_update)</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> error_ud(dofs_per_block);</div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dof_handler_ref.n_dofs(); ++i)</div>
<div class="line">&nbsp;       <span class="keywordflow">if</span> (!constraints.is_constrained(i))</div>
<div class="line">&nbsp;         error_ud(i) = newton_update(i);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     error_update.norm = error_ud.l2_norm();</div>
<div class="line">&nbsp;     error_update.u = error_ud.block(u_dof).l2_norm();</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Solidget_total_solution"></a> </p><h4>Solid::get_total_solution</h4>
<p>This function provides the total solution, which is valid at any Newton step. This is required as, to reduce computational error, the total solution is only updated at the end of the timestep.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a></div>
<div class="line">&nbsp;   Solid&lt;dim,NumberType&gt;::get_total_solution(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;solution_delta) <span class="keyword">const</span></div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> solution_total(solution_n);</div>
<div class="line">&nbsp;     solution_total += solution_delta;</div>
<div class="line">&nbsp;     <span class="keywordflow">return</span> solution_total;</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Solidassemble_system"></a> </p><h4>Solid::assemble_system</h4>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keyword">struct </span>Assembler_Base</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <span class="keyword">virtual</span> ~Assembler_Base() {}</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Here we deal with the tangent matrix assembly structures. The PerTaskData object stores local contributions.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>PerTaskData_ASM</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keyword">const</span> Solid&lt;dim,NumberType&gt;          *solid;</div>
<div class="line">&nbsp;       <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFullMatrix.html">FullMatrix&lt;double&gt;</a>                   cell_matrix;</div>
<div class="line">&nbsp;       <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classVector.html">Vector&lt;double&gt;</a>                       cell_rhs;</div>
<div class="line">&nbsp;       std::vector&lt;types::global_dof_index&gt; local_dof_indices;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       PerTaskData_ASM(<span class="keyword">const</span> Solid&lt;dim,NumberType&gt; *solid)</div>
<div class="line">&nbsp;         :</div>
<div class="line">&nbsp;         solid (solid),</div>
<div class="line">&nbsp;         cell_matrix(solid-&gt;dofs_per_cell, solid-&gt;dofs_per_cell),</div>
<div class="line">&nbsp;         cell_rhs(solid-&gt;dofs_per_cell),</div>
<div class="line">&nbsp;         local_dof_indices(solid-&gt;dofs_per_cell)</div>
<div class="line">&nbsp;       {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       void reset()</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         cell_matrix = 0.0;</div>
<div class="line">&nbsp;         cell_rhs = 0.0;</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassFullMatrix_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classFullMatrix.html">FullMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/full__matrix_8h_source.html#l00078">full_matrix.h:79</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classVector.html">Vector</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/vector_8h_source.html#l00108">vector.h:109</a></div></div>
</div><!-- fragment --><p>On the other hand, the ScratchData object stores the larger objects such as the shape-function values array (<code>Nx</code>) and a shape function gradient and symmetric gradient vector which we will use during the assembly.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">struct </span>ScratchData_ASM</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a>               &amp;solution_total;</div>
<div class="line">&nbsp;       std::vector&lt;Tensor&lt;2, dim,NumberType&gt; &gt;  solution_grads_u_total;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFEValues.html">FEValues&lt;dim&gt;</a>                fe_values_ref;</div>
<div class="line">&nbsp;       <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a>            fe_face_values_ref;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       std::vector&lt;std::vector&lt;Tensor&lt;2, dim,NumberType&gt; &gt; &gt;         grad_Nx;</div>
<div class="line">&nbsp;       std::vector&lt;std::vector&lt;SymmetricTensor&lt;2,dim,NumberType&gt; &gt; &gt; symm_grad_Nx;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       ScratchData_ASM(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFiniteElement.html">FiniteElement&lt;dim&gt;</a> &amp;fe_cell,</div>
<div class="line">&nbsp;                       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classQGauss.html">QGauss&lt;dim&gt;</a> &amp;qf_cell,</div>
<div class="line">&nbsp;                       <span class="keyword">const</span> <a class="code hl_enumeration" href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> uf_cell,</div>
<div class="line">&nbsp;                       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classQGauss.html">QGauss&lt;dim-1&gt;</a> &amp; qf_face,</div>
<div class="line">&nbsp;                       <span class="keyword">const</span> <a class="code hl_enumeration" href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> uf_face,</div>
<div class="line">&nbsp;                       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;solution_total)</div>
<div class="line">&nbsp;         :</div>
<div class="line">&nbsp;         solution_total(solution_total),</div>
<div class="line">&nbsp;         solution_grads_u_total(qf_cell.size()),</div>
<div class="line">&nbsp;         fe_values_ref(fe_cell, qf_cell, uf_cell),</div>
<div class="line">&nbsp;         fe_face_values_ref(fe_cell, qf_face, uf_face),</div>
<div class="line">&nbsp;         grad_Nx(qf_cell.size(),</div>
<div class="line">&nbsp;                 <a class="code hl_namespace" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html">std</a>::vector&lt;<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor</a>&lt;2,dim,NumberType&gt; &gt;(fe_cell.dofs_per_cell)),</div>
<div class="line">&nbsp;         symm_grad_Nx(qf_cell.size(),</div>
<div class="line">&nbsp;                      <a class="code hl_namespace" href="https://www.dealii.org/current/doxygen/deal.II/namespacestd.html">std</a>::vector&lt;<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor</a>&lt;2,dim,NumberType&gt; &gt;</div>
<div class="line">&nbsp;                      (fe_cell.dofs_per_cell))</div>
<div class="line">&nbsp;       {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       ScratchData_ASM(const ScratchData_ASM &amp;rhs)</div>
<div class="line">&nbsp;         :</div>
<div class="line">&nbsp;         solution_total (rhs.solution_total),</div>
<div class="line">&nbsp;         solution_grads_u_total(rhs.solution_grads_u_total),</div>
<div class="line">&nbsp;         fe_values_ref(rhs.fe_values_ref.get_fe(),</div>
<div class="line">&nbsp;                       rhs.fe_values_ref.get_quadrature(),</div>
<div class="line">&nbsp;                       rhs.fe_values_ref.get_update_flags()),</div>
<div class="line">&nbsp;         fe_face_values_ref(rhs.fe_face_values_ref.get_fe(),</div>
<div class="line">&nbsp;                            rhs.fe_face_values_ref.get_quadrature(),</div>
<div class="line">&nbsp;                            rhs.fe_face_values_ref.get_update_flags()),</div>
<div class="line">&nbsp;         grad_Nx(rhs.grad_Nx),</div>
<div class="line">&nbsp;         symm_grad_Nx(rhs.symm_grad_Nx)</div>
<div class="line">&nbsp;       {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       void reset()</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         const unsigned <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classint.html">int</a> n_q_points = fe_values_ref.get_quadrature().size();</div>
<div class="line">&nbsp;         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs_per_cell = fe_values_ref.dofs_per_cell;</div>
<div class="line">&nbsp;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; n_q_points; ++q_point)</div>
<div class="line">&nbsp;           {</div>
<div class="line">&nbsp;             <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>( grad_Nx[q_point].size() == n_dofs_per_cell,</div>
<div class="line">&nbsp;                     ExcInternalError());</div>
<div class="line">&nbsp;             <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>( symm_grad_Nx[q_point].size() == n_dofs_per_cell,</div>
<div class="line">&nbsp;                     ExcInternalError());</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;             solution_grads_u_total[q_point] = <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,NumberType&gt;</a>();</div>
<div class="line">&nbsp;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; n_dofs_per_cell; ++k)</div>
<div class="line">&nbsp;               {</div>
<div class="line">&nbsp;                 grad_Nx[q_point][k] = <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,NumberType&gt;</a>();</div>
<div class="line">&nbsp;                 symm_grad_Nx[q_point][k] = <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a>();</div>
<div class="line">&nbsp;               }</div>
<div class="line">&nbsp;           }</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     };</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassFEFaceValues_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classFEFaceValues.html">FEFaceValues</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe_2fe__values_8h_source.html#l04319">fe_values.h:4320</a></div></div>
<div class="ttc" id="aclassFiniteElement_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classFiniteElement.html">FiniteElement</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II_2fe_2fe_8h_source.html#l00655">fe.h:656</a></div></div>
<div class="ttc" id="aclassTensor_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/tensor_8h_source.html#l00515">tensor.h:516</a></div></div>
<div class="ttc" id="aclassint_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classint.html">int</a></div></div>
<div class="ttc" id="agroup__feaccess_html_gaa94b67d2fdcc390690c523f28019e52f"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a></div><div class="ttdeci">UpdateFlags</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe__update__flags_8h_source.html#l00064">fe_update_flags.h:65</a></div></div>
</div><!-- fragment --><p>Of course, we still have to define how we assemble the tangent matrix contribution for a single cell.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     assemble_system_one_cell(<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="https://www.dealii.org/current/doxygen/deal.II/group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;cell,</div>
<div class="line">&nbsp;                              ScratchData_ASM &amp;scratch,</div>
<div class="line">&nbsp;                              PerTaskData_ASM &amp;data)</div>
<div class="line">&nbsp;     {</div>
</div><!-- fragment --><p>Due to the C++ specialization rules, we need one more level of indirection in order to define the assembly routine for all different number. The next function call is specialized for each NumberType, but to prevent having to specialize the whole class along with it we have inlined the definition of the other functions that are common to all implementations.</p>
<div class="fragment"><div class="line">&nbsp;       assemble_system_tangent_residual_one_cell(cell, scratch, data);</div>
<div class="line">&nbsp;       assemble_neumann_contribution_one_cell(cell, scratch, data);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>This function adds the local contribution to the system matrix.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     copy_local_to_global_ASM(<span class="keyword">const</span> PerTaskData_ASM &amp;data)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classAffineConstraints.html">AffineConstraints&lt;double&gt;</a> &amp;constraints = data.solid-&gt;constraints;</div>
<div class="line">&nbsp;       <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockSparseMatrix.html">BlockSparseMatrix&lt;double&gt;</a> &amp;tangent_matrix = <span class="keyword">const_cast&lt;</span>Solid&lt;dim,NumberType&gt; *<span class="keyword">&gt;</span>(data.solid)-&gt;tangent_matrix;</div>
<div class="line">&nbsp;       <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;system_rhs =  <span class="keyword">const_cast&lt;</span>Solid&lt;dim,NumberType&gt; *<span class="keyword">&gt;</span>(data.solid)-&gt;system_rhs;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       constraints.distribute_local_to_global(</div>
<div class="line">&nbsp;         data.cell_matrix, data.cell_rhs,</div>
<div class="line">&nbsp;         data.local_dof_indices,</div>
<div class="line">&nbsp;         tangent_matrix, system_rhs);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">protected</span>:</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>This function needs to exist in the base class for Workstream to work with a reference to the base class.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     assemble_system_tangent_residual_one_cell(<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="https://www.dealii.org/current/doxygen/deal.II/group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;<span class="comment">/*cell*/</span>,</div>
<div class="line">&nbsp;                                               ScratchData_ASM &amp;<span class="comment">/*scratch*/</span>,</div>
<div class="line">&nbsp;                                               PerTaskData_ASM &amp;<span class="comment">/*data*/</span>)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, ExcPureFunctionCalled());</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     assemble_neumann_contribution_one_cell(<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="https://www.dealii.org/current/doxygen/deal.II/group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;cell,</div>
<div class="line">&nbsp;                                            ScratchData_ASM &amp;scratch,</div>
<div class="line">&nbsp;                                            PerTaskData_ASM &amp;data)</div>
<div class="line">&nbsp;     {</div>
</div><!-- fragment --><p>Aliases for data referenced from the Solid class</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;n_q_points_f = data.solid-&gt;n_q_points_f;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;dofs_per_cell = data.solid-&gt;dofs_per_cell;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> Parameters::AllParameters &amp;parameters = data.solid-&gt;parameters;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> Time &amp;time = data.solid-&gt;time;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFESystem.html">FESystem&lt;dim&gt;</a> &amp;fe = data.solid-&gt;fe;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;u_dof = data.solid-&gt;u_dof;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Next we assemble the Neumann contribution. We first check to see it the cell face exists on a boundary on which a traction is applied and add the contribution if this is the case.</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = 0; face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell;</div>
<div class="line">&nbsp;            ++face)</div>
<div class="line">&nbsp;         <span class="keywordflow">if</span> (cell-&gt;face(face)-&gt;at_boundary() == <span class="keyword">true</span></div>
<div class="line">&nbsp;             &amp;&amp; cell-&gt;face(face)-&gt;boundary_id() == 11)</div>
<div class="line">&nbsp;           {</div>
<div class="line">&nbsp;             scratch.fe_face_values_ref.reinit(cell, face);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f_q_point = 0; f_q_point &lt; n_q_points_f;</div>
<div class="line">&nbsp;                  ++f_q_point)</div>
<div class="line">&nbsp;               {</div>
</div><!-- fragment --><p>We specify the traction in reference configuration. For this problem, a defined total vertical force is applied in the reference configuration. The direction of the applied traction is assumed not to evolve with the deformation of the domain.</p>
<p>Note that the contributions to the right hand side vector we compute here only exist in the displacement components of the vector.</p>
<div class="fragment"><div class="line">&nbsp;                 <span class="keyword">const</span> <span class="keywordtype">double</span> time_ramp = (time.current() / time.end());</div>
<div class="line">&nbsp;                 <span class="keyword">const</span> <span class="keywordtype">double</span> magnitude  = (1.0/(16.0*parameters.scale*1.0*parameters.scale))*time_ramp; <span class="comment">// (Total force) / (RHS surface area)</span></div>
<div class="line">&nbsp;                 <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;1,dim&gt;</a> dir;</div>
<div class="line">&nbsp;                 dir[1] = 1.0;</div>
<div class="line">&nbsp;                 <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;1, dim&gt;</a> traction  = magnitude*dir;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">&nbsp;                   {</div>
<div class="line">&nbsp;                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_group =</div>
<div class="line">&nbsp;                       fe.system_to_base_index(i).first.first;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;                     <span class="keywordflow">if</span> (i_group == u_dof)</div>
<div class="line">&nbsp;                       {</div>
<div class="line">&nbsp;                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component_i =</div>
<div class="line">&nbsp;                           fe.system_to_component_index(i).first;</div>
<div class="line">&nbsp;                         <span class="keyword">const</span> <span class="keywordtype">double</span> Ni =</div>
<div class="line">&nbsp;                           scratch.fe_face_values_ref.shape_value(i,</div>
<div class="line">&nbsp;                                                                  f_q_point);</div>
<div class="line">&nbsp;                         <span class="keyword">const</span> <span class="keywordtype">double</span> JxW = scratch.fe_face_values_ref.JxW(</div>
<div class="line">&nbsp;                                              f_q_point);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;                         data.cell_rhs(i) += (Ni * traction[component_i])</div>
<div class="line">&nbsp;                                             * JxW;</div>
<div class="line">&nbsp;                       }</div>
<div class="line">&nbsp;                   }</div>
<div class="line">&nbsp;               }</div>
<div class="line">&nbsp;           }</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">&nbsp;   <span class="keyword">struct </span>Assembler&lt;dim,double&gt; : Assembler_Base&lt;dim,double&gt;</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <span class="keyword">typedef</span> <span class="keywordtype">double</span> NumberType;</div>
<div class="line">&nbsp;     <span class="keyword">using </span>typename Assembler_Base&lt;dim,NumberType&gt;::ScratchData_ASM;</div>
<div class="line">&nbsp;     <span class="keyword">using </span>typename Assembler_Base&lt;dim,NumberType&gt;::PerTaskData_ASM;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">virtual</span> ~Assembler() {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     assemble_system_tangent_residual_one_cell(<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="https://www.dealii.org/current/doxygen/deal.II/group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;cell,</div>
<div class="line">&nbsp;                                               ScratchData_ASM &amp;scratch,</div>
<div class="line">&nbsp;                                               PerTaskData_ASM &amp;data) <span class="keyword">override</span></div>
<div class="line">&nbsp;     {</div>
</div><!-- fragment --><p>Aliases for data referenced from the Solid class</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;n_q_points = data.solid-&gt;n_q_points;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;dofs_per_cell = data.solid-&gt;dofs_per_cell;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFESystem.html">FESystem&lt;dim&gt;</a> &amp;fe = data.solid-&gt;fe;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;u_dof = data.solid-&gt;u_dof;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_struct" href="https://www.dealii.org/current/doxygen/deal.II/structFEValuesExtractors_1_1Vector.html">FEValuesExtractors::Vector</a> &amp;u_fe = data.solid-&gt;u_fe;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       data.reset();</div>
<div class="line">&nbsp;       scratch.reset();</div>
<div class="line">&nbsp;       scratch.fe_values_ref.reinit(cell);</div>
<div class="line">&nbsp;       cell-&gt;get_dof_indices(data.local_dof_indices);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">const</span> std::vector&lt;std::shared_ptr&lt;const PointHistory&lt;dim,NumberType&gt; &gt; &gt; lqph =</div>
<div class="line">&nbsp;         <span class="keyword">const_cast&lt;</span><span class="keyword">const </span>Solid&lt;dim,NumberType&gt; *<span class="keyword">&gt;</span>(data.solid)-&gt;quadrature_point_history.get_data(cell);</div>
<div class="line">&nbsp;       <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(lqph.size() == n_q_points, ExcInternalError());</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We first need to find the solution gradients at quadrature points inside the current cell and then we update each local QP using the displacement gradient:</p>
<div class="fragment"><div class="line">&nbsp;       scratch.fe_values_ref[u_fe].get_function_gradients(scratch.solution_total,</div>
<div class="line">&nbsp;                                                          scratch.solution_grads_u_total);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Now we build the local cell stiffness matrix. Since the global and local system matrices are symmetric, we can exploit this property by building only the lower half of the local matrix and copying the values to the upper half.</p>
<p>In doing so, we first extract some configuration dependent variables from our QPH history objects for the current quadrature point.</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; n_q_points; ++q_point)</div>
<div class="line">&nbsp;         {</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,NumberType&gt;</a> &amp;grad_u = scratch.solution_grads_u_total[q_point];</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,NumberType&gt;</a> F = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#ac78561117677f21c2a7c40d7baa6ec3a">Physics::Elasticity::Kinematics::F</a>(grad_u);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> NumberType               det_F = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a041d56f5d878527b2a9d274c47a6f037">determinant</a>(F);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,NumberType&gt;</a> F_bar = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#a781a30559fe3772562e4d501dd570361">Physics::Elasticity::Kinematics::F_iso</a>(F);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> b_bar = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#a85ec995f892fbfa61268d84cbe2fefea">Physics::Elasticity::Kinematics::b</a>(F_bar);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,NumberType&gt;</a> F_inv = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a3c55ee67c6ff751ca15b94e1435c2fa5">invert</a>(F);</div>
<div class="line">&nbsp;           <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(det_F &gt; NumberType(0.0), ExcInternalError());</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; dofs_per_cell; ++k)</div>
<div class="line">&nbsp;             {</div>
<div class="line">&nbsp;               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k_group = fe.system_to_base_index(k).first.first;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;               <span class="keywordflow">if</span> (k_group == u_dof)</div>
<div class="line">&nbsp;                 {</div>
<div class="line">&nbsp;                   scratch.grad_Nx[q_point][k] = scratch.fe_values_ref[u_fe].gradient(k, q_point) * F_inv;</div>
<div class="line">&nbsp;                   scratch.symm_grad_Nx[q_point][k] = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a14699dc5951cc4578e4a7371699674b2">symmetrize</a>(scratch.grad_Nx[q_point][k]);</div>
<div class="line">&nbsp;                 }</div>
<div class="line">&nbsp;               <span class="keywordflow">else</span></div>
<div class="line">&nbsp;                 <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(k_group &lt;= u_dof, ExcInternalError());</div>
<div class="line">&nbsp;             }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,NumberType&gt;</a> tau = lqph[q_point]-&gt;get_tau(det_F,b_bar);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;4,dim,NumberType&gt;</a> Jc  = lqph[q_point]-&gt;get_Jc(det_F,b_bar);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,NumberType&gt;</a> tau_ns (tau);</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a781a30559fe3772562e4d501dd570361"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#a781a30559fe3772562e4d501dd570361">Physics::Elasticity::Kinematics::F_iso</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; F_iso(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a85ec995f892fbfa61268d84cbe2fefea"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#a85ec995f892fbfa61268d84cbe2fefea">Physics::Elasticity::Kinematics::b</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; b(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_ac78561117677f21c2a7c40d7baa6ec3a"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#ac78561117677f21c2a7c40d7baa6ec3a">Physics::Elasticity::Kinematics::F</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; F(const Tensor&lt; 2, dim, Number &gt; &amp;Grad_u)</div></div>
<div class="ttc" id="asymmetric__tensor_8h_html_a041d56f5d878527b2a9d274c47a6f037"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a041d56f5d878527b2a9d274c47a6f037">determinant</a></div><div class="ttdeci">DEAL_II_HOST constexpr Number determinant(const SymmetricTensor&lt; 2, dim, Number &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h_source.html#l02800">symmetric_tensor.h:2800</a></div></div>
<div class="ttc" id="asymmetric__tensor_8h_html_a14699dc5951cc4578e4a7371699674b2"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a14699dc5951cc4578e4a7371699674b2">symmetrize</a></div><div class="ttdeci">DEAL_II_HOST constexpr SymmetricTensor&lt; 2, dim, Number &gt; symmetrize(const Tensor&lt; 2, dim, Number &gt; &amp;t)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h_source.html#l03536">symmetric_tensor.h:3536</a></div></div>
<div class="ttc" id="asymmetric__tensor_8h_html_a3c55ee67c6ff751ca15b94e1435c2fa5"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a3c55ee67c6ff751ca15b94e1435c2fa5">invert</a></div><div class="ttdeci">DEAL_II_HOST constexpr SymmetricTensor&lt; 2, dim, Number &gt; invert(const SymmetricTensor&lt; 2, dim, Number &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h_source.html#l03458">symmetric_tensor.h:3458</a></div></div>
</div><!-- fragment --><p>Next we define some aliases to make the assembly process easier to follow</p>
<div class="fragment"><div class="line">&nbsp;           <span class="keyword">const</span> std::vector&lt;SymmetricTensor&lt;2, dim&gt; &gt; &amp;symm_grad_Nx = scratch.symm_grad_Nx[q_point];</div>
<div class="line">&nbsp;           <span class="keyword">const</span> std::vector&lt;Tensor&lt;2, dim&gt; &gt; &amp;grad_Nx = scratch.grad_Nx[q_point];</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <span class="keywordtype">double</span> JxW = scratch.fe_values_ref.JxW(q_point);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">&nbsp;             {</div>
<div class="line">&nbsp;               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component_i = fe.system_to_component_index(i).first;</div>
<div class="line">&nbsp;               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_group     = fe.system_to_base_index(i).first.first;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;               <span class="keywordflow">if</span> (i_group == u_dof)</div>
<div class="line">&nbsp;                 data.cell_rhs(i) -= (symm_grad_Nx[i] * tau) * JxW;</div>
<div class="line">&nbsp;               <span class="keywordflow">else</span></div>
<div class="line">&nbsp;                 <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(i_group &lt;= u_dof, ExcInternalError());</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line">&nbsp;                 {</div>
<div class="line">&nbsp;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component_j = fe.system_to_component_index(j).first;</div>
<div class="line">&nbsp;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_group     = fe.system_to_base_index(j).first.first;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>This is the <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-467" style="width: 1.967em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.122em, 1001.61em, 1.372em, -999.997em); top: -1.009em; left: 0em;"><span class="mrow" id="MathJax-Span-468"><span class="msubsup" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 1.61em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="texatom" id="MathJax-Span-472"><span class="mrow" id="MathJax-Span-473"><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Main-bold;">k</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-475"><span class="mrow" id="MathJax-Span-476"><span class="texatom" id="MathJax-Span-477"><span class="mrow" id="MathJax-Span-478"><span class="mi" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Main-bold;">u</span></span></span><span class="texatom" id="MathJax-Span-480"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-size: 70.7%; font-family: MathJax_Main-bold;">u</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.015em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">\mathsf{\mathbf{k}}_{\mathbf{u} \mathbf{u}}</script> contribution. It comprises a material contribution, and a geometrical stress contribution which is only added along the local matrix diagonals:</p>
<div class="fragment"><div class="line">&nbsp;                   <span class="keywordflow">if</span> ((i_group == j_group) &amp;&amp; (i_group == u_dof))</div>
<div class="line">&nbsp;                     {</div>
<div class="line">&nbsp;                       data.cell_matrix(i, j) += symm_grad_Nx[i] * Jc <span class="comment">// The material contribution:</span></div>
<div class="line">&nbsp;                                                 * symm_grad_Nx[j] * JxW;</div>
<div class="line">&nbsp;                       <span class="keywordflow">if</span> (component_i == component_j) <span class="comment">// geometrical stress contribution</span></div>
<div class="line">&nbsp;                         data.cell_matrix(i, j) += grad_Nx[i][component_i] * tau_ns</div>
<div class="line">&nbsp;                                                   * grad_Nx[j][component_j] * JxW;</div>
<div class="line">&nbsp;                     }</div>
<div class="line">&nbsp;                   <span class="keywordflow">else</span></div>
<div class="line">&nbsp;                     <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>((i_group &lt;= u_dof) &amp;&amp; (j_group &lt;= u_dof),</div>
<div class="line">&nbsp;                            ExcInternalError());</div>
<div class="line">&nbsp;                 }</div>
<div class="line">&nbsp;             }</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Finally, we need to copy the lower half of the local matrix into the upper half:</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">&nbsp;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = i + 1; j &lt; dofs_per_cell; ++j)</div>
<div class="line">&nbsp;           data.cell_matrix(i, j) = data.cell_matrix(j, i);</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; #ifdef ENABLE_SACADO_FORMULATION</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">&nbsp;   <span class="keyword">struct </span>Assembler&lt;dim,Sacado::Fad::DFad&lt;double&gt; &gt; : Assembler_Base&lt;dim,Sacado::Fad::DFad&lt;double&gt; &gt;</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <span class="keyword">typedef</span> Sacado::Fad::DFad&lt;double&gt; ADNumberType;</div>
<div class="line">&nbsp;     <span class="keyword">using </span>typename Assembler_Base&lt;dim,ADNumberType&gt;::ScratchData_ASM;</div>
<div class="line">&nbsp;     <span class="keyword">using </span>typename Assembler_Base&lt;dim,ADNumberType&gt;::PerTaskData_ASM;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">virtual</span> ~Assembler() {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     assemble_system_tangent_residual_one_cell(<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="https://www.dealii.org/current/doxygen/deal.II/group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;cell,</div>
<div class="line">&nbsp;                                               ScratchData_ASM &amp;scratch,</div>
<div class="line">&nbsp;                                               PerTaskData_ASM &amp;data) <span class="keyword">override</span></div>
<div class="line">&nbsp;     {</div>
</div><!-- fragment --><p>Aliases for data referenced from the Solid class</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;n_q_points = data.solid-&gt;n_q_points;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;dofs_per_cell = data.solid-&gt;dofs_per_cell;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFESystem.html">FESystem&lt;dim&gt;</a> &amp;fe = data.solid-&gt;fe;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;u_dof = data.solid-&gt;u_dof;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_struct" href="https://www.dealii.org/current/doxygen/deal.II/structFEValuesExtractors_1_1Vector.html">FEValuesExtractors::Vector</a> &amp;u_fe = data.solid-&gt;u_fe;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       data.reset();</div>
<div class="line">&nbsp;       scratch.reset();</div>
<div class="line">&nbsp;       scratch.fe_values_ref.reinit(cell);</div>
<div class="line">&nbsp;       cell-&gt;get_dof_indices(data.local_dof_indices);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">const</span> std::vector&lt;std::shared_ptr&lt;const PointHistory&lt;dim,ADNumberType&gt; &gt; &gt; lqph =</div>
<div class="line">&nbsp;         <span class="keyword">const_cast&lt;</span><span class="keyword">const </span>Solid&lt;dim,ADNumberType&gt; *<span class="keyword">&gt;</span>(data.solid)-&gt;quadrature_point_history.get_data(cell);</div>
<div class="line">&nbsp;       <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(lqph.size() == n_q_points, ExcInternalError());</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_independent_variables = data.local_dof_indices.size();</div>
<div class="line">&nbsp;       std::vector&lt;double&gt; local_dof_values(n_independent_variables);</div>
<div class="line">&nbsp;       cell-&gt;get_dof_values(scratch.solution_total,</div>
<div class="line">&nbsp;                            local_dof_values.begin(),</div>
<div class="line">&nbsp;                            local_dof_values.end());</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We now retrieve a set of degree-of-freedom values that have the operations that are performed with them tracked.</p>
<div class="fragment"><div class="line">&nbsp;       std::vector&lt;ADNumberType&gt; local_dof_values_ad (n_independent_variables);</div>
<div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_independent_variables; ++i)</div>
<div class="line">&nbsp;         local_dof_values_ad[i] = ADNumberType(n_independent_variables, i, local_dof_values[i]);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Compute all values, gradients etc. based on sensitive AD degree-of-freedom values.</p>
<div class="fragment"><div class="line">&nbsp;       scratch.fe_values_ref[u_fe].get_function_gradients_from_local_dof_values(</div>
<div class="line">&nbsp;         local_dof_values_ad,</div>
<div class="line">&nbsp;         scratch.solution_grads_u_total);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Accumulate the residual value for each degree of freedom. Note: Its important that the vectors is initialised (zero'd) correctly.</p>
<div class="fragment"><div class="line">&nbsp;       std::vector&lt;ADNumberType&gt; residual_ad (dofs_per_cell, ADNumberType(0.0));</div>
<div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; n_q_points; ++q_point)</div>
<div class="line">&nbsp;         {</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,ADNumberType&gt;</a> &amp;grad_u = scratch.solution_grads_u_total[q_point];</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,ADNumberType&gt;</a> F = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#ac78561117677f21c2a7c40d7baa6ec3a">Physics::Elasticity::Kinematics::F</a>(grad_u);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> ADNumberType               det_F = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a041d56f5d878527b2a9d274c47a6f037">determinant</a>(F);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,ADNumberType&gt;</a> F_bar = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#a781a30559fe3772562e4d501dd570361">Physics::Elasticity::Kinematics::F_iso</a>(F);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,ADNumberType&gt;</a> b_bar = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#a85ec995f892fbfa61268d84cbe2fefea">Physics::Elasticity::Kinematics::b</a>(F_bar);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,ADNumberType&gt;</a> F_inv = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a3c55ee67c6ff751ca15b94e1435c2fa5">invert</a>(F);</div>
<div class="line">&nbsp;           <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(det_F &gt; ADNumberType(0.0), ExcInternalError());</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; dofs_per_cell; ++k)</div>
<div class="line">&nbsp;             {</div>
<div class="line">&nbsp;               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k_group = fe.system_to_base_index(k).first.first;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;               <span class="keywordflow">if</span> (k_group == u_dof)</div>
<div class="line">&nbsp;                 {</div>
<div class="line">&nbsp;                   scratch.grad_Nx[q_point][k] = scratch.fe_values_ref[u_fe].gradient(k, q_point) * F_inv;</div>
<div class="line">&nbsp;                   scratch.symm_grad_Nx[q_point][k] = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a14699dc5951cc4578e4a7371699674b2">symmetrize</a>(scratch.grad_Nx[q_point][k]);</div>
<div class="line">&nbsp;                 }</div>
<div class="line">&nbsp;               <span class="keywordflow">else</span></div>
<div class="line">&nbsp;                 <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(k_group &lt;= u_dof, ExcInternalError());</div>
<div class="line">&nbsp;             }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,ADNumberType&gt;</a> tau = lqph[q_point]-&gt;get_tau(det_F,b_bar);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Next we define some position-dependent aliases, again to make the assembly process easier to follow.</p>
<div class="fragment"><div class="line">&nbsp;           <span class="keyword">const</span> std::vector&lt;SymmetricTensor&lt;2, dim,ADNumberType&gt; &gt; &amp;symm_grad_Nx = scratch.symm_grad_Nx[q_point];</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <span class="keywordtype">double</span> JxW = scratch.fe_values_ref.JxW(q_point);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">&nbsp;             {</div>
<div class="line">&nbsp;               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_group     = fe.system_to_base_index(i).first.first;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;               <span class="keywordflow">if</span> (i_group == u_dof)</div>
<div class="line">&nbsp;                 residual_ad[i] += (symm_grad_Nx[i] * tau) * JxW;</div>
<div class="line">&nbsp;               <span class="keywordflow">else</span></div>
<div class="line">&nbsp;                 <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(i_group &lt;= u_dof, ExcInternalError());</div>
<div class="line">&nbsp;             }</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> I=0; I&lt;n_independent_variables; ++I)</div>
<div class="line">&nbsp;         {</div>
<div class="line">&nbsp;           <span class="keyword">const</span> ADNumberType &amp;residual_I = residual_ad[I];</div>
<div class="line">&nbsp;           data.cell_rhs(I) = -residual_I.val(); <span class="comment">// RHS = - residual</span></div>
<div class="line">&nbsp;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> J=0; J&lt;n_independent_variables; ++J)</div>
<div class="line">&nbsp;             {</div>
</div><!-- fragment --><p>Compute the gradients of the residual entry [forward-mode]</p>
<div class="fragment"><div class="line">&nbsp;               data.cell_matrix(I,J) = residual_I.dx(J); <span class="comment">// linearisation_IJ</span></div>
<div class="line">&nbsp;             }</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">&nbsp;   <span class="keyword">struct </span>Assembler&lt;dim,Sacado::Rad::ADvar&lt;Sacado::Fad::DFad&lt;double&gt; &gt; &gt; : Assembler_Base&lt;dim,Sacado::Rad::ADvar&lt;Sacado::Fad::DFad&lt;double&gt; &gt; &gt;</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <span class="keyword">typedef</span> Sacado::Fad::DFad&lt;double&gt;       ADDerivType;</div>
<div class="line">&nbsp;     <span class="keyword">typedef</span> Sacado::Rad::ADvar&lt;ADDerivType&gt; ADNumberType;</div>
<div class="line">&nbsp;     <span class="keyword">using </span>typename Assembler_Base&lt;dim,ADNumberType&gt;::ScratchData_ASM;</div>
<div class="line">&nbsp;     <span class="keyword">using </span>typename Assembler_Base&lt;dim,ADNumberType&gt;::PerTaskData_ASM;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">virtual</span> ~Assembler() {}</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line">&nbsp;     assemble_system_tangent_residual_one_cell(<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="https://www.dealii.org/current/doxygen/deal.II/group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;dim&gt;::active_cell_iterator</a> &amp;cell,</div>
<div class="line">&nbsp;                                               ScratchData_ASM &amp;scratch,</div>
<div class="line">&nbsp;                                               PerTaskData_ASM &amp;data) <span class="keyword">override</span></div>
<div class="line">&nbsp;     {</div>
</div><!-- fragment --><p>Aliases for data referenced from the Solid class</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;n_q_points = data.solid-&gt;n_q_points;</div>
<div class="line">&nbsp;       <span class="keyword">const</span> <a class="code hl_struct" href="https://www.dealii.org/current/doxygen/deal.II/structFEValuesExtractors_1_1Vector.html">FEValuesExtractors::Vector</a> &amp;u_fe = data.solid-&gt;u_fe;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       data.reset();</div>
<div class="line">&nbsp;       scratch.reset();</div>
<div class="line">&nbsp;       scratch.fe_values_ref.reinit(cell);</div>
<div class="line">&nbsp;       cell-&gt;get_dof_indices(data.local_dof_indices);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">const</span> std::vector&lt;std::shared_ptr&lt;const PointHistory&lt;dim,ADNumberType&gt; &gt; &gt; lqph =</div>
<div class="line">&nbsp;         data.solid-&gt;quadrature_point_history.get_data(cell);</div>
<div class="line">&nbsp;       <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(lqph.size() == n_q_points, ExcInternalError());</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_independent_variables = data.local_dof_indices.size();</div>
<div class="line">&nbsp;       std::vector&lt;double&gt; local_dof_values(n_independent_variables);</div>
<div class="line">&nbsp;       cell-&gt;get_dof_values(scratch.solution_total,</div>
<div class="line">&nbsp;                            local_dof_values.begin(),</div>
<div class="line">&nbsp;                            local_dof_values.end());</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We now retrieve a set of degree-of-freedom values that have the operations that are performed with them tracked.</p>
<div class="fragment"><div class="line">&nbsp;       std::vector&lt;ADNumberType&gt; local_dof_values_ad (n_independent_variables);</div>
<div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_independent_variables; ++i)</div>
<div class="line">&nbsp;         local_dof_values_ad[i] = ADDerivType(n_independent_variables, i, local_dof_values[i]);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Compute all values, gradients etc. based on sensitive AD degree-of-freedom values.</p>
<div class="fragment"><div class="line">&nbsp;       scratch.fe_values_ref[u_fe].get_function_gradients_from_local_dof_values(</div>
<div class="line">&nbsp;         local_dof_values_ad,</div>
<div class="line">&nbsp;         scratch.solution_grads_u_total);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Next we compute the total potential energy of the element. This is defined as follows: Total energy = (internal - external) energies Note: Its important that this value is initialised (zero'd) correctly.</p>
<div class="fragment"><div class="line">&nbsp;       ADNumberType cell_energy_ad = ADNumberType(0.0);</div>
<div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; n_q_points; ++q_point)</div>
<div class="line">&nbsp;         {</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,ADNumberType&gt;</a> &amp;grad_u = scratch.solution_grads_u_total[q_point];</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,ADNumberType&gt;</a> F = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#ac78561117677f21c2a7c40d7baa6ec3a">Physics::Elasticity::Kinematics::F</a>(grad_u);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> ADNumberType               det_F = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/symmetric__tensor_8h.html#a041d56f5d878527b2a9d274c47a6f037">determinant</a>(F);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classTensor.html">Tensor&lt;2,dim,ADNumberType&gt;</a> F_bar = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#a781a30559fe3772562e4d501dd570361">Physics::Elasticity::Kinematics::F_iso</a>(F);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSymmetricTensor.html">SymmetricTensor&lt;2,dim,ADNumberType&gt;</a> b_bar = <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespacePhysics_1_1Elasticity_1_1Kinematics.html#a85ec995f892fbfa61268d84cbe2fefea">Physics::Elasticity::Kinematics::b</a>(F_bar);</div>
<div class="line">&nbsp;           <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(det_F &gt; ADNumberType(0.0), ExcInternalError());</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Next we define some position-dependent aliases, again to make the assembly process easier to follow.</p>
<div class="fragment"><div class="line">&nbsp;           <span class="keyword">const</span> <span class="keywordtype">double</span> JxW = scratch.fe_values_ref.JxW(q_point);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keyword">const</span> ADNumberType Psi = lqph[q_point]-&gt;get_Psi(det_F,b_bar);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We extract the configuration-dependent material energy from our QPH history objects for the current quadrature point and integrate its contribution to increment the total cell energy.</p>
<div class="fragment"><div class="line">&nbsp;           cell_energy_ad += Psi * JxW;</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Compute derivatives of reverse-mode AD variables</p>
<div class="fragment"><div class="line">&nbsp;       ADNumberType::Gradcomp();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> I=0; I&lt;n_independent_variables; ++I)</div>
<div class="line">&nbsp;         {</div>
</div><!-- fragment --><p>This computes the adjoint df/dX_{i} [reverse-mode]</p>
<div class="fragment"><div class="line">&nbsp;           <span class="keyword">const</span> ADDerivType residual_I = local_dof_values_ad[I].adj();</div>
<div class="line">&nbsp;           data.cell_rhs(I) = -residual_I.val(); <span class="comment">// RHS = - residual</span></div>
<div class="line">&nbsp;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> J=0; J&lt;n_independent_variables; ++J)</div>
<div class="line">&nbsp;             {</div>
</div><!-- fragment --><p>Compute the gradients of the residual entry [forward-mode]</p>
<div class="fragment"><div class="line">&nbsp;               data.cell_matrix(I,J) = residual_I.dx(J); <span class="comment">// linearisation_IJ</span></div>
<div class="line">&nbsp;             }</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   };</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; #endif</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Since we use TBB for assembly, we simply setup a copy of the data structures required for the process and pass them, along with the memory addresses of the assembly functions to the <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/namespaceWorkStream.html">WorkStream</a> object for processing. Note that we must ensure that the matrix is reset before any assembly operations can occur.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::assemble_system(<span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;solution_delta)</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     timer.enter_subsection(<span class="stringliteral">"Assemble linear system"</span>);</div>
<div class="line">&nbsp;     std::cout &lt;&lt; <span class="stringliteral">" ASM "</span> &lt;&lt; std::flush;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     tangent_matrix = 0.0;</div>
<div class="line">&nbsp;     system_rhs = 0.0;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_enumeration" href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> uf_cell(<a class="code hl_enumvalue" href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div>
<div class="line">&nbsp;                               <a class="code hl_enumvalue" href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_enumeration" href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> uf_face(<a class="code hl_enumvalue" href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> |</div>
<div class="line">&nbsp;                               <a class="code hl_enumvalue" href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keyword">const</span> <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> solution_total(get_total_solution(solution_delta));</div>
<div class="line">&nbsp;     <span class="keyword">typename</span> Assembler_Base&lt;dim,NumberType&gt;::PerTaskData_ASM per_task_data(<span class="keyword">this</span>);</div>
<div class="line">&nbsp;     <span class="keyword">typename</span> Assembler_Base&lt;dim,NumberType&gt;::ScratchData_ASM scratch_data(fe, qf_cell, uf_cell, qf_face, uf_face, solution_total);</div>
<div class="line">&nbsp;     Assembler&lt;dim,NumberType&gt; assembler;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceWorkStream.html#a0c5d332d74a4df80784140218896b169">WorkStream::run</a>(dof_handler_ref.begin_active(),</div>
<div class="line">&nbsp;                     dof_handler_ref.end(),</div>
<div class="line">&nbsp;                     <span class="keyword">static_cast&lt;</span>Assembler_Base&lt;dim,NumberType&gt;&amp;<span class="keyword">&gt;</span>(assembler),</div>
<div class="line">&nbsp;                     &amp;Assembler_Base&lt;dim,NumberType&gt;::assemble_system_one_cell,</div>
<div class="line">&nbsp;                     &amp;Assembler_Base&lt;dim,NumberType&gt;::copy_local_to_global_ASM,</div>
<div class="line">&nbsp;                     scratch_data,</div>
<div class="line">&nbsp;                     per_task_data);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     timer.leave_subsection();</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="ttc" id="agroup__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdeci">@ update_JxW_values</div><div class="ttdoc">Transformed quadrature weights.</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe__update__flags_8h_source.html#l00135">fe_update_flags.h:135</a></div></div>
<div class="ttc" id="agroup__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdeci">@ update_gradients</div><div class="ttdoc">Shape function gradients.</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe__update__flags_8h_source.html#l00082">fe_update_flags.h:82</a></div></div>
<div class="ttc" id="anamespaceWorkStream_html_a0c5d332d74a4df80784140218896b169"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceWorkStream.html#a0c5d332d74a4df80784140218896b169">WorkStream::run</a></div><div class="ttdeci">void run(const std::vector&lt; std::vector&lt; Iterator &gt; &gt; &amp;colored_iterators, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length=2 *MultithreadInfo::n_threads(), const unsigned int chunk_size=8)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/work__stream_8h_source.html#l01270">work_stream.h:1270</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Solidmake_constraints"></a> </p><h4>Solid::make_constraints</h4>
<p>The constraints for this problem are simple to describe. However, since we are dealing with an iterative Newton method, it should be noted that any displacement constraints should only be specified at the zeroth iteration and subsequently no additional contributions are to be made since the constraints are already exactly satisfied.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::make_constraints(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;it_nr)</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     std::cout &lt;&lt; <span class="stringliteral">" CST "</span> &lt;&lt; std::flush;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Since the constraints are different at different Newton iterations, we need to clear the constraints matrix and completely rebuild it. However, after the first iteration, the constraints remain the same and we can simply skip the rebuilding step if we do not clear it.</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordflow">if</span> (it_nr &gt; 1)</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span>;</div>
<div class="line">&nbsp;     <span class="keyword">const</span> <span class="keywordtype">bool</span> apply_dirichlet_bc = (it_nr == 0);</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>The boundary conditions for the indentation problem are as follows: On the -x face (ID = 1), we set up a zero-displacement condition, -y and +y traction free boundary condition (don't need to take care); -z and +z faces (ID = 2) are not allowed to move along z axis so that it is a plane strain problem. Finally, as described earlier, +x face (ID = 11) has an the applied distributed shear force (converted by total force per unit area) which needs to be taken care as an inhomogeneous Newmann boundary condition.</p>
<p>In the following, we will have to tell the function interpolation boundary values which components of the solution vector should be constrained (i.e., whether it's the x-, y-, z-displacements or combinations thereof). This is done using <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classComponentMask.html">ComponentMask</a> objects (see <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/DEALGlossary.html#GlossComponentMask">GlossComponentMask</a>) which we can get from the finite element if we provide it with an extractor object for the component we wish to select. To this end we first set up such extractor objects and later use it when generating the relevant component masks:</p>
<div class="fragment"><div class="line">&nbsp;     <span class="keywordflow">if</span> (apply_dirichlet_bc)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       constraints.clear();</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Fixed left hand side of the beam</p>
<div class="fragment"><div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         <span class="keyword">const</span> <span class="keywordtype">int</span> boundary_id = 1;</div>
<div class="line">&nbsp;         <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceVectorTools.html#ab2562d41bb26f362043f9719a8cd9b87">VectorTools::interpolate_boundary_values</a>(dof_handler_ref,</div>
<div class="line">&nbsp;                                                 boundary_id,</div>
<div class="line">&nbsp;                                                 <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction&lt;dim&gt;</a>(n_components),</div>
<div class="line">&nbsp;                                                 constraints,</div>
<div class="line">&nbsp;                                                 fe.component_mask(u_fe));</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassFunctions_1_1ZeroFunction_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/function_8h_source.html#l00510">function.h:511</a></div></div>
<div class="ttc" id="anamespaceVectorTools_html_ab2562d41bb26f362043f9719a8cd9b87"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceVectorTools.html#ab2562d41bb26f362043f9719a8cd9b87">VectorTools::interpolate_boundary_values</a></div><div class="ttdeci">void interpolate_boundary_values(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const std::map&lt; types::boundary_id, const Function&lt; spacedim, number &gt; * &gt; &amp;function_map, std::map&lt; types::global_dof_index, number &gt; &amp;boundary_values, const ComponentMask &amp;component_mask=ComponentMask())</div></div>
</div><!-- fragment --><p>Zero Z-displacement through thickness direction This corresponds to a plane strain condition being imposed on the beam</p>
<div class="fragment"><div class="line">&nbsp;       <span class="keywordflow">if</span> (dim == 3)</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         <span class="keyword">const</span> <span class="keywordtype">int</span> boundary_id = 2;</div>
<div class="line">&nbsp;         <span class="keyword">const</span> <a class="code hl_struct" href="https://www.dealii.org/current/doxygen/deal.II/structFEValuesExtractors_1_1Scalar.html">FEValuesExtractors::Scalar</a> z_displacement(2);</div>
<div class="line">&nbsp;         <a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/namespaceVectorTools.html#ab2562d41bb26f362043f9719a8cd9b87">VectorTools::interpolate_boundary_values</a>(dof_handler_ref,</div>
<div class="line">&nbsp;                                                 boundary_id,</div>
<div class="line">&nbsp;                                                 <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction&lt;dim&gt;</a>(n_components),</div>
<div class="line">&nbsp;                                                 constraints,</div>
<div class="line">&nbsp;                                                 fe.component_mask(z_displacement));</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp;     <span class="keywordflow">else</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <span class="keywordflow">if</span> (constraints.has_inhomogeneities())</div>
<div class="line">&nbsp;       {</div>
<div class="line">&nbsp;         <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classAffineConstraints.html">AffineConstraints&lt;double&gt;</a> homogeneous_constraints(constraints);</div>
<div class="line">&nbsp;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dof = 0; dof != dof_handler_ref.n_dofs(); ++dof)</div>
<div class="line">&nbsp;           <span class="keywordflow">if</span> (homogeneous_constraints.is_inhomogeneously_constrained(dof))</div>
<div class="line">&nbsp;             homogeneous_constraints.set_inhomogeneity(dof, 0.0);</div>
<div class="line">&nbsp;         constraints.clear();</div>
<div class="line">&nbsp;         constraints.copy_from(homogeneous_constraints);</div>
<div class="line">&nbsp;       }</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     constraints.close();</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="astructFEValuesExtractors_1_1Scalar_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/structFEValuesExtractors_1_1Scalar.html">FEValuesExtractors::Scalar</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/fe__values__extractors_8h_source.html#l00095">fe_values_extractors.h:96</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Solidsolve_linear_system"></a> </p><h4>Solid::solve_linear_system</h4>
<p>As the system is composed of a single block, defining a solution scheme for the linear problem is straight-forward.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   std::pair&lt;unsigned int, double&gt;</div>
<div class="line">&nbsp;   Solid&lt;dim,NumberType&gt;::solve_linear_system(<a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> &amp;newton_update)</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> A(dofs_per_block);</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVector.html">BlockVector&lt;double&gt;</a> B(dofs_per_block);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lin_it = 0;</div>
<div class="line">&nbsp;     <span class="keywordtype">double</span> lin_res = 0.0;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>We solve for the incremental displacement <span class="MathJax_Preview" style=""></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-483" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.19em, 2.384em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-486"><span class="mrow" id="MathJax-Span-487"><span class="mi" id="MathJax-Span-488" style="font-family: MathJax_Main-bold;">u</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">d\mathbf{u}</script>.</p>
<div class="fragment"><div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       timer.enter_subsection(<span class="stringliteral">"Linear solver"</span>);</div>
<div class="line">&nbsp;       std::cout &lt;&lt; <span class="stringliteral">" SLV "</span> &lt;&lt; std::flush;</div>
<div class="line">&nbsp;       <span class="keywordflow">if</span> (parameters.type_lin == <span class="stringliteral">"CG"</span>)</div>
<div class="line">&nbsp;         {</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <span class="keywordtype">int</span> solver_its = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(</div>
<div class="line">&nbsp;                                     tangent_matrix.block(u_dof, u_dof).m()</div>
<div class="line">&nbsp;                                     * parameters.max_iterations_lin);</div>
<div class="line">&nbsp;           <span class="keyword">const</span> <span class="keywordtype">double</span> tol_sol = parameters.tol_lin</div>
<div class="line">&nbsp;                                  * system_rhs.block(u_dof).l2_norm();</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSolverControl.html">SolverControl</a> solver_control(solver_its, tol_sol);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classGrowingVectorMemory.html">GrowingVectorMemory&lt;Vector&lt;double&gt;</a> &gt; GVM;</div>
<div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a> &gt; solver_CG(solver_control, GVM);</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassGrowingVectorMemory_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classGrowingVectorMemory.html">GrowingVectorMemory</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II_2lac_2vector__memory_8h_source.html#l00315">vector_memory.h:316</a></div></div>
<div class="ttc" id="aclassSolverCG_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/solver__cg_8h_source.html#l00177">solver_cg.h:178</a></div></div>
<div class="ttc" id="aclassSolverControl_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/solver__control_8h_source.html#l00067">solver_control.h:68</a></div></div>
</div><!-- fragment --><p>We've chosen by default a SSOR preconditioner as it appears to provide the fastest solver convergence characteristics for this problem on a single-thread machine. However, for multicore computing, the Jacobi preconditioner which is multithreaded may converge quicker for larger linear systems.</p>
<div class="fragment"><div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classPreconditionSelector.html">PreconditionSelector&lt;SparseMatrix&lt;double&gt;</a>, <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classVector.html">Vector&lt;double&gt;</a> &gt;</div>
<div class="line">&nbsp;           preconditioner (parameters.preconditioner_type,</div>
<div class="line">&nbsp;                           parameters.preconditioner_relaxation);</div>
<div class="line">&nbsp;           preconditioner.use_matrix(tangent_matrix.block(u_dof, u_dof));</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           solver_CG.solve(tangent_matrix.block(u_dof, u_dof),</div>
<div class="line">&nbsp;                           newton_update.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVectorBase.html#abbdf8c439c3773ffecac2721f3db7f88">block</a>(u_dof),</div>
<div class="line">&nbsp;                           system_rhs.block(u_dof),</div>
<div class="line">&nbsp;                           preconditioner);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           lin_it = solver_control.last_step();</div>
<div class="line">&nbsp;           lin_res = solver_control.last_value();</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parameters.type_lin == <span class="stringliteral">"Direct"</span>)</div>
<div class="line">&nbsp;         {</div>
<div class="ttc" id="aclassBlockVectorBase_html_abbdf8c439c3773ffecac2721f3db7f88"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classBlockVectorBase.html#abbdf8c439c3773ffecac2721f3db7f88">BlockVectorBase::block</a></div><div class="ttdeci">BlockType &amp; block(const unsigned int i)</div></div>
<div class="ttc" id="aclassPreconditionSelector_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classPreconditionSelector.html">PreconditionSelector</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/precondition__selector_8h_source.html#l00101">precondition_selector.h:102</a></div></div>
</div><!-- fragment --><p>Otherwise if the problem is small enough, a direct solver can be utilised.</p>
<div class="fragment"><div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classSparseDirectUMFPACK.html">SparseDirectUMFPACK</a> A_direct;</div>
<div class="line">&nbsp;           A_direct.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classSparseDirectUMFPACK.html#a25b1d3c7dbb88158a76165a4a56a16d6">initialize</a>(tangent_matrix.block(u_dof, u_dof));</div>
<div class="line">&nbsp;           A_direct.vmult(newton_update.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classBlockVectorBase.html#abbdf8c439c3773ffecac2721f3db7f88">block</a>(u_dof), system_rhs.block(u_dof));</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           lin_it = 1;</div>
<div class="line">&nbsp;           lin_res = 0.0;</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp;       <span class="keywordflow">else</span></div>
<div class="line">&nbsp;         <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (<span class="keyword">false</span>, ExcMessage(<span class="stringliteral">"Linear solver type not implemented"</span>));</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       timer.leave_subsection();</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassSparseDirectUMFPACK_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classSparseDirectUMFPACK.html">SparseDirectUMFPACK</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/sparse__direct_8h_source.html#l00087">sparse_direct.h:88</a></div></div>
<div class="ttc" id="aclassSparseDirectUMFPACK_html_a25b1d3c7dbb88158a76165a4a56a16d6"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classSparseDirectUMFPACK.html#a25b1d3c7dbb88158a76165a4a56a16d6">SparseDirectUMFPACK::initialize</a></div><div class="ttdeci">void initialize(const SparsityPattern &amp;sparsity_pattern)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/sparse__direct_8cc_source.html#l00068">sparse_direct.cc:68</a></div></div>
</div><!-- fragment --><p>Now that we have the displacement update, distribute the constraints back to the Newton update:</p>
<div class="fragment"><div class="line">&nbsp;     constraints.distribute(newton_update);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     <span class="keywordflow">return</span> std::make_pair(lin_it, lin_res);</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p><a class="anchor" id="Solidoutput_results"></a> </p><h4>Solid::output_results</h4>
<p>Here we present how the results are written to file to be viewed using ParaView or Visit. The method is similar to that shown in the tutorials so will not be discussed in detail.</p>
<div class="fragment"><div class="line">&nbsp;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim,<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line">&nbsp;   <span class="keywordtype">void</span> Solid&lt;dim,NumberType&gt;::output_results() const</div>
<div class="line">&nbsp;   {</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div>
<div class="line">&nbsp;     std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">&nbsp;     data_component_interpretation(dim,</div>
<div class="line">&nbsp;                                   <a class="code hl_enumvalue" href="https://www.dealii.org/current/doxygen/deal.II/namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     std::vector&lt;std::string&gt; solution_name(dim, <span class="stringliteral">"displacement"</span>);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     data_out.attach_dof_handler(dof_handler_ref);</div>
<div class="line">&nbsp;     data_out.add_data_vector(solution_n,</div>
<div class="line">&nbsp;                              solution_name,</div>
<div class="line">&nbsp;                              <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classDataOut.html">DataOut&lt;dim&gt;::type_dof_data</a>,</div>
<div class="line">&nbsp;                              data_component_interpretation);</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassDataOut_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/numerics_2data__out_8h_source.html#l00147">data_out.h:148</a></div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a></div><div class="ttdeci">@ component_is_part_of_vector</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/data__component__interpretation_8h_source.html#l00059">data_component_interpretation.h:59</a></div></div>
</div><!-- fragment --><p>Since we are dealing with a large deformation problem, it would be nice to display the result on a displaced grid! The <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classMappingQEulerian.html">MappingQEulerian</a> class linked with the <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classDataOut.html">DataOut</a> class provides an interface through which this can be achieved without physically moving the grid points in the <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classTriangulation.html">Triangulation</a> object ourselves. We first need to copy the solution to a temporary vector and then create the Eulerian mapping. We also specify the polynomial degree to the <a class="el" href="https://www.dealii.org/current/doxygen/deal.II/classDataOut.html">DataOut</a> object in order to produce a more refined output data set when higher order polynomials are used.</p>
<div class="fragment"><div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classVector.html">Vector&lt;double&gt;</a> soln(solution_n.size());</div>
<div class="line">&nbsp;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; soln.size(); ++i)</div>
<div class="line">&nbsp;       soln(i) = solution_n(i);</div>
<div class="line">&nbsp;     <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classMappingQEulerian.html">MappingQEulerian&lt;dim&gt;</a> q_mapping(degree, dof_handler_ref, soln);</div>
<div class="line">&nbsp;     data_out.build_patches(q_mapping, degree);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     std::ostringstream filename;</div>
<div class="line">&nbsp;     filename &lt;&lt; <span class="stringliteral">"solution-"</span> &lt;&lt; time.get_timestep() &lt;&lt; <span class="stringliteral">".vtk"</span>;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;     std::ofstream output(filename.str().c_str());</div>
<div class="line">&nbsp;     data_out.write_vtk(output);</div>
<div class="line">&nbsp;   }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassMappingQEulerian_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classMappingQEulerian.html">MappingQEulerian</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/mapping__q__eulerian_8h_source.html#l00095">mapping_q_eulerian.h:96</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Mainfunction"></a> </p><h3>Main function</h3>
<p>Lastly we provide the main driver function which appears no different to the other tutorials.</p>
<div class="fragment"><div class="line">&nbsp; <span class="keywordtype">int</span> main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">&nbsp; {</div>
<div class="line">&nbsp;   <span class="keyword">using namespace </span><a class="code hl_namespace" href="https://www.dealii.org/current/doxygen/deal.II/namespacedealii.html">dealii</a>;</div>
<div class="line">&nbsp;   <span class="keyword">using namespace </span>Cook_Membrane;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = 3;</div>
<div class="line">&nbsp;   <span class="keywordflow">try</span></div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       <a class="code hl_variable" href="https://www.dealii.org/current/doxygen/deal.II/logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code hl_function" href="https://www.dealii.org/current/doxygen/deal.II/classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line">&nbsp;       Parameters::AllParameters parameters(<span class="stringliteral">"parameters.prm"</span>);</div>
<div class="line">&nbsp;       <span class="keywordflow">if</span> (parameters.automatic_differentiation_order == 0)</div>
<div class="line">&nbsp;         {</div>
<div class="line">&nbsp;           std::cout &lt;&lt; <span class="stringliteral">"Assembly method: Residual and linearisation are computed manually."</span> &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassLogStream_html_a8028e970ad8388596d625ed463894e98"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classLogStream.html#a8028e970ad8388596d625ed463894e98">LogStream::depth_console</a></div><div class="ttdeci">unsigned int depth_console(const unsigned int n)</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/logstream_8cc_source.html#l00350">logstream.cc:350</a></div></div>
<div class="ttc" id="alogstream_8h_html_ac643e79bd992f1a9bd0dca5b9f2859fb"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a></div><div class="ttdeci">LogStream deallog</div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/logstream_8cc_source.html#l00037">logstream.cc:37</a></div></div>
</div><!-- fragment --><p>Allow multi-threading</p>
<div class="fragment"><div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv,</div>
<div class="line">&nbsp;                                                               ::numbers::invalid_unsigned_int);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keyword">typedef</span> <span class="keywordtype">double</span> NumberType;</div>
<div class="line">&nbsp;           Solid&lt;dim,NumberType&gt; solid_3d(parameters);</div>
<div class="line">&nbsp;           solid_3d.run();</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp; #ifdef ENABLE_SACADO_FORMULATION</div>
<div class="line">&nbsp;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parameters.automatic_differentiation_order == 1)</div>
<div class="line">&nbsp;         {</div>
<div class="line">&nbsp;           std::cout &lt;&lt; <span class="stringliteral">"Assembly method: Residual computed manually; linearisation performed using AD."</span> &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
<div class="ttc" id="aclassUtilities_1_1MPI_1_1MPI__InitFinalize_html"><div class="ttname"><a href="https://www.dealii.org/current/doxygen/deal.II/classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a></div><div class="ttdef"><b>Definition</b> <a href="https://www.dealii.org/current/doxygen/deal.II/mpi_8h_source.html#l01083">mpi.h:1084</a></div></div>
</div><!-- fragment --><p>Allow multi-threading</p>
<div class="fragment"><div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv,</div>
<div class="line">&nbsp;                                                               ::numbers::invalid_unsigned_int);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keyword">typedef</span> Sacado::Fad::DFad&lt;double&gt; NumberType;</div>
<div class="line">&nbsp;           Solid&lt;dim,NumberType&gt; solid_3d(parameters);</div>
<div class="line">&nbsp;           solid_3d.run();</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (parameters.automatic_differentiation_order == 2)</div>
<div class="line">&nbsp;         {</div>
<div class="line">&nbsp;           std::cout &lt;&lt; <span class="stringliteral">"Assembly method: Residual and linearisation computed using AD."</span> &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
</div><!-- fragment --><p>Sacado Rad-Fad is not thread-safe, so disable threading. Parallisation using MPI would be possible though.</p>
<div class="fragment"><div class="line">&nbsp;           <a class="code hl_class" href="https://www.dealii.org/current/doxygen/deal.II/classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv,</div>
<div class="line">&nbsp;                                                               1);</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;           <span class="keyword">typedef</span> Sacado::Rad::ADvar&lt; Sacado::Fad::DFad&lt;double&gt; &gt; NumberType;</div>
<div class="line">&nbsp;           Solid&lt;dim,NumberType&gt; solid_3d(parameters);</div>
<div class="line">&nbsp;           solid_3d.run();</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp; #endif</div>
<div class="line">&nbsp;       <span class="keywordflow">else</span></div>
<div class="line">&nbsp;         {</div>
<div class="line">&nbsp;           <a class="code hl_define" href="https://www.dealii.org/current/doxygen/deal.II/group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line">&nbsp;                       ExcMessage(<span class="stringliteral">"The selected assembly method is not supported. "</span></div>
<div class="line">&nbsp;                                  <span class="stringliteral">"You need deal.II 9.0 and Trilinos with the Sacado package "</span></div>
<div class="line">&nbsp;                                  <span class="stringliteral">"to enable assembly using automatic differentiation."</span>));</div>
<div class="line">&nbsp;         }</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp;   <span class="keywordflow">catch</span> (std::exception &amp;exc)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div>
<div class="line">&nbsp;                 &lt;&lt; <span class="stringliteral">"----------------------------------------------------"</span></div>
<div class="line">&nbsp;                 &lt;&lt; std::endl;</div>
<div class="line">&nbsp;       std::cerr &lt;&lt; <span class="stringliteral">"Exception on processing: "</span> &lt;&lt; std::endl &lt;&lt; exc.what()</div>
<div class="line">&nbsp;                 &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">"Aborting!"</span> &lt;&lt; std::endl</div>
<div class="line">&nbsp;                 &lt;&lt; <span class="stringliteral">"----------------------------------------------------"</span></div>
<div class="line">&nbsp;                 &lt;&lt; std::endl;</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> 1;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp;   <span class="keywordflow">catch</span> (...)</div>
<div class="line">&nbsp;     {</div>
<div class="line">&nbsp;       std::cerr &lt;&lt; std::endl &lt;&lt; std::endl</div>
<div class="line">&nbsp;                 &lt;&lt; <span class="stringliteral">"----------------------------------------------------"</span></div>
<div class="line">&nbsp;                 &lt;&lt; std::endl;</div>
<div class="line">&nbsp;       std::cerr &lt;&lt; <span class="stringliteral">"Unknown exception!"</span> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">"Aborting!"</span></div>
<div class="line">&nbsp;                 &lt;&lt; std::endl</div>
<div class="line">&nbsp;                 &lt;&lt; <span class="stringliteral">"----------------------------------------------------"</span></div>
<div class="line">&nbsp;                 &lt;&lt; std::endl;</div>
<div class="line">&nbsp;       <span class="keywordflow">return</span> 1;</div>
<div class="line">&nbsp;     }</div>
<div class="line">&nbsp; </div>
<div class="line">&nbsp;   <span class="keywordflow">return</span> 0;</div>
<div class="line">&nbsp; }</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.7-->
<!-- start footer part -->
<hr class="footer"><address class="footer"><small>
Generated by&nbsp;<a href="https://www.doxygen.org/index.html"><img class="footer" src="./The deal.II Library_ The &#39;Quasi-Static Finite-Strain Compressible Elasticity&#39; code gallery program_files/doxygen.svg" width="104" height="31" alt="doxygen"></a> 1.9.7
</small></address>


<div id="powerTip"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Caligraphic, sans-serif;"></div></div></body></html>